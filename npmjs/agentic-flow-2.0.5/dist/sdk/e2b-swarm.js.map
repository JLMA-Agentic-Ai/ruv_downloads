{"version":3,"file":"e2b-swarm.js","sourceRoot":"","sources":["../../src/sdk/e2b-swarm.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * E2B Swarm Orchestrator - Multi-agent swarm with E2B sandbox isolation\n *\n * Spawns specialized agents in isolated E2B sandboxes for:\n * - Parallel code execution\n * - Secure multi-agent coordination\n * - Resource-isolated task processing\n */\n\nimport { logger } from \"../utils/logger.js\";\nimport { E2BSandboxManager, ExecutionResult, E2BSandboxConfig } from \"./e2b-sandbox.js\";\n\n/**\n * E2B Agent capabilities\n */\nexport type E2BAgentCapability =\n  | 'python-executor'      // Execute Python code\n  | 'javascript-executor'  // Execute JavaScript/Node.js\n  | 'shell-executor'       // Execute shell commands\n  | 'data-analyst'         // Data processing and analysis\n  | 'code-reviewer'        // Static analysis and review\n  | 'test-runner'          // Run tests in isolation\n  | 'security-scanner'     // Security analysis\n  | 'performance-profiler' // Performance testing\n  | 'ml-trainer'           // Machine learning tasks\n  | 'api-tester';          // API endpoint testing\n\n/**\n * E2B Agent configuration\n */\nexport interface E2BAgentConfig {\n  id: string;\n  name: string;\n  capability: E2BAgentCapability;\n  template?: string;\n  timeout?: number;\n  envVars?: Record<string, string>;\n  packages?: string[];\n}\n\n/**\n * E2B Agent instance\n */\nexport interface E2BAgent {\n  id: string;\n  name: string;\n  capability: E2BAgentCapability;\n  sandbox: E2BSandboxManager;\n  status: 'initializing' | 'ready' | 'busy' | 'error' | 'terminated';\n  tasksCompleted: number;\n  totalExecutionTime: number;\n  errors: number;\n  createdAt: number;\n}\n\n/**\n * Task for E2B agent execution\n */\nexport interface E2BTask {\n  id: string;\n  type: 'python' | 'javascript' | 'shell' | 'file-write' | 'file-read';\n  code: string;\n  targetAgent?: string;\n  capability?: E2BAgentCapability;\n  priority?: 'low' | 'medium' | 'high' | 'critical';\n  timeout?: number;\n  metadata?: Record<string, any>;\n}\n\n/**\n * Task result\n */\nexport interface E2BTaskResult {\n  taskId: string;\n  agentId: string;\n  success: boolean;\n  output: string;\n  error?: string;\n  executionTime: number;\n  metadata?: Record<string, any>;\n}\n\n/**\n * Swarm metrics\n */\nexport interface E2BSwarmMetrics {\n  totalAgents: number;\n  activeAgents: number;\n  tasksCompleted: number;\n  tasksInProgress: number;\n  totalExecutionTime: number;\n  averageExecutionTime: number;\n  errorRate: number;\n  agentUtilization: Record<string, number>;\n}\n\n/**\n * E2B Swarm Orchestrator\n */\nexport class E2BSwarmOrchestrator {\n  private agents: Map<string, E2BAgent> = new Map();\n  private taskQueue: E2BTask[] = [];\n  private taskResults: Map<string, E2BTaskResult> = new Map();\n  private isRunning: boolean = false;\n  private config: {\n    maxAgents: number;\n    defaultTimeout: number;\n    retryAttempts: number;\n    loadBalancing: 'round-robin' | 'least-busy' | 'capability-match';\n  };\n\n  constructor(config?: Partial<E2BSwarmOrchestrator['config']>) {\n    this.config = {\n      maxAgents: config?.maxAgents || 10,\n      defaultTimeout: config?.defaultTimeout || 300000,\n      retryAttempts: config?.retryAttempts || 3,\n      loadBalancing: config?.loadBalancing || 'capability-match'\n    };\n  }\n\n  /**\n   * Initialize the swarm\n   */\n  async initialize(): Promise<boolean> {\n    logger.info('E2B Swarm initializing', { maxAgents: this.config.maxAgents });\n    this.isRunning = true;\n    return true;\n  }\n\n  /**\n   * Spawn a new E2B agent with specific capability\n   */\n  async spawnAgent(config: E2BAgentConfig): Promise<E2BAgent | null> {\n    if (this.agents.size >= this.config.maxAgents) {\n      logger.warn('Max agents reached', { max: this.config.maxAgents });\n      return null;\n    }\n\n    const sandbox = new E2BSandboxManager({\n      apiKey: process.env.E2B_API_KEY,\n      template: config.template || this.getTemplateForCapability(config.capability),\n      timeout: config.timeout || this.config.defaultTimeout,\n      envVars: config.envVars\n    });\n\n    const agent: E2BAgent = {\n      id: config.id,\n      name: config.name,\n      capability: config.capability,\n      sandbox,\n      status: 'initializing',\n      tasksCompleted: 0,\n      totalExecutionTime: 0,\n      errors: 0,\n      createdAt: Date.now()\n    };\n\n    this.agents.set(agent.id, agent);\n\n    try {\n      const useCodeInterpreter = ['python-executor', 'data-analyst', 'ml-trainer'].includes(config.capability);\n      const created = await sandbox.create(useCodeInterpreter);\n\n      if (!created) {\n        agent.status = 'error';\n        logger.error('Failed to create E2B sandbox for agent', { agentId: agent.id });\n        return null;\n      }\n\n      // Install required packages for capability\n      if (config.packages && config.packages.length > 0) {\n        const pkgManager = ['python-executor', 'data-analyst', 'ml-trainer'].includes(config.capability) ? 'pip' : 'npm';\n        await sandbox.installPackages(config.packages, pkgManager);\n      }\n\n      agent.status = 'ready';\n      logger.info('E2B agent spawned', { id: agent.id, name: agent.name, capability: config.capability });\n\n      return agent;\n    } catch (error) {\n      agent.status = 'error';\n      agent.errors++;\n      logger.error('Error spawning E2B agent', { agentId: agent.id, error: (error as Error).message });\n      return null;\n    }\n  }\n\n  /**\n   * Spawn multiple agents in parallel\n   */\n  async spawnAgents(configs: E2BAgentConfig[]): Promise<E2BAgent[]> {\n    const results = await Promise.allSettled(\n      configs.map(config => this.spawnAgent(config))\n    );\n\n    return results\n      .filter((r): r is PromiseFulfilledResult<E2BAgent | null> => r.status === 'fulfilled')\n      .map(r => r.value)\n      .filter((a): a is E2BAgent => a !== null);\n  }\n\n  /**\n   * Execute a task on the swarm\n   */\n  async executeTask(task: E2BTask): Promise<E2BTaskResult> {\n    const startTime = Date.now();\n\n    // Find best agent for task\n    const agent = this.selectAgent(task);\n    if (!agent) {\n      return {\n        taskId: task.id,\n        agentId: 'none',\n        success: false,\n        output: '',\n        error: 'No suitable agent available',\n        executionTime: 0\n      };\n    }\n\n    agent.status = 'busy';\n\n    try {\n      let result: ExecutionResult;\n\n      switch (task.type) {\n        case 'python':\n          result = await agent.sandbox.runPython(task.code);\n          break;\n        case 'javascript':\n          result = await agent.sandbox.runJavaScript(task.code);\n          break;\n        case 'shell':\n          result = await agent.sandbox.runCommand('sh', ['-c', task.code]);\n          break;\n        case 'file-write':\n          const writeResult = await agent.sandbox.writeFile(task.metadata?.path || '/tmp/output.txt', task.code);\n          result = { success: writeResult.success, output: writeResult.path, error: writeResult.error, logs: [] };\n          break;\n        case 'file-read':\n          const readResult = await agent.sandbox.readFile(task.code);\n          result = { success: readResult.success, output: readResult.content || '', error: readResult.error, logs: [] };\n          break;\n        default:\n          result = { success: false, output: '', error: `Unknown task type: ${task.type}`, logs: [] };\n      }\n\n      const executionTime = Date.now() - startTime;\n      agent.tasksCompleted++;\n      agent.totalExecutionTime += executionTime;\n      agent.status = 'ready';\n\n      const taskResult: E2BTaskResult = {\n        taskId: task.id,\n        agentId: agent.id,\n        success: result.success,\n        output: result.output,\n        error: result.error,\n        executionTime,\n        metadata: task.metadata\n      };\n\n      this.taskResults.set(task.id, taskResult);\n      return taskResult;\n\n    } catch (error) {\n      agent.errors++;\n      agent.status = 'ready';\n\n      const taskResult: E2BTaskResult = {\n        taskId: task.id,\n        agentId: agent.id,\n        success: false,\n        output: '',\n        error: (error as Error).message,\n        executionTime: Date.now() - startTime\n      };\n\n      this.taskResults.set(task.id, taskResult);\n      return taskResult;\n    }\n  }\n\n  /**\n   * Execute multiple tasks in parallel\n   */\n  async executeTasks(tasks: E2BTask[]): Promise<E2BTaskResult[]> {\n    // Group by priority\n    const critical = tasks.filter(t => t.priority === 'critical');\n    const high = tasks.filter(t => t.priority === 'high');\n    const medium = tasks.filter(t => t.priority === 'medium' || !t.priority);\n    const low = tasks.filter(t => t.priority === 'low');\n\n    const orderedTasks = [...critical, ...high, ...medium, ...low];\n\n    // Execute with concurrency based on available agents\n    const concurrency = Math.min(this.getReadyAgents().length, orderedTasks.length);\n    const results: E2BTaskResult[] = [];\n\n    for (let i = 0; i < orderedTasks.length; i += concurrency) {\n      const batch = orderedTasks.slice(i, i + concurrency);\n      const batchResults = await Promise.all(batch.map(task => this.executeTask(task)));\n      results.push(...batchResults);\n    }\n\n    return results;\n  }\n\n  /**\n   * Select best agent for a task\n   */\n  private selectAgent(task: E2BTask): E2BAgent | null {\n    const readyAgents = this.getReadyAgents();\n\n    if (readyAgents.length === 0) return null;\n\n    // If specific agent requested\n    if (task.targetAgent) {\n      const agent = this.agents.get(task.targetAgent);\n      if (agent && agent.status === 'ready') return agent;\n    }\n\n    switch (this.config.loadBalancing) {\n      case 'round-robin':\n        return readyAgents[0];\n\n      case 'least-busy':\n        return readyAgents.reduce((min, agent) =>\n          agent.tasksCompleted < min.tasksCompleted ? agent : min\n        );\n\n      case 'capability-match':\n      default:\n        // Match task type to capability\n        const capabilityMap: Record<string, E2BAgentCapability[]> = {\n          'python': ['python-executor', 'data-analyst', 'ml-trainer'],\n          'javascript': ['javascript-executor', 'api-tester'],\n          'shell': ['shell-executor', 'security-scanner', 'test-runner'],\n          'file-write': ['shell-executor', 'python-executor', 'javascript-executor'],\n          'file-read': ['shell-executor', 'python-executor', 'javascript-executor']\n        };\n\n        const preferredCapabilities = capabilityMap[task.type] || [];\n        const matchingAgents = readyAgents.filter(a =>\n          task.capability ? a.capability === task.capability : preferredCapabilities.includes(a.capability)\n        );\n\n        return matchingAgents.length > 0 ? matchingAgents[0] : readyAgents[0];\n    }\n  }\n\n  /**\n   * Get ready agents\n   */\n  private getReadyAgents(): E2BAgent[] {\n    return Array.from(this.agents.values()).filter(a => a.status === 'ready');\n  }\n\n  /**\n   * Get template for capability\n   */\n  private getTemplateForCapability(capability: E2BAgentCapability): string {\n    const templates: Record<E2BAgentCapability, string> = {\n      'python-executor': 'base',\n      'javascript-executor': 'base',\n      'shell-executor': 'base',\n      'data-analyst': 'base',\n      'code-reviewer': 'base',\n      'test-runner': 'base',\n      'security-scanner': 'base',\n      'performance-profiler': 'base',\n      'ml-trainer': 'base',\n      'api-tester': 'base'\n    };\n    return templates[capability] || 'base';\n  }\n\n  /**\n   * Get swarm metrics\n   */\n  getMetrics(): E2BSwarmMetrics {\n    const agents = Array.from(this.agents.values());\n    const totalTasks = agents.reduce((sum, a) => sum + a.tasksCompleted, 0);\n    const totalErrors = agents.reduce((sum, a) => sum + a.errors, 0);\n    const totalTime = agents.reduce((sum, a) => sum + a.totalExecutionTime, 0);\n\n    const utilization: Record<string, number> = {};\n    for (const agent of agents) {\n      utilization[agent.id] = agent.tasksCompleted > 0\n        ? agent.totalExecutionTime / (Date.now() - agent.createdAt)\n        : 0;\n    }\n\n    return {\n      totalAgents: agents.length,\n      activeAgents: agents.filter(a => a.status === 'busy').length,\n      tasksCompleted: totalTasks,\n      tasksInProgress: agents.filter(a => a.status === 'busy').length,\n      totalExecutionTime: totalTime,\n      averageExecutionTime: totalTasks > 0 ? totalTime / totalTasks : 0,\n      errorRate: totalTasks > 0 ? totalErrors / (totalTasks + totalErrors) : 0,\n      agentUtilization: utilization\n    };\n  }\n\n  /**\n   * Get all agents\n   */\n  getAgents(): E2BAgent[] {\n    return Array.from(this.agents.values());\n  }\n\n  /**\n   * Get agent by ID\n   */\n  getAgent(id: string): E2BAgent | undefined {\n    return this.agents.get(id);\n  }\n\n  /**\n   * Terminate an agent\n   */\n  async terminateAgent(id: string): Promise<boolean> {\n    const agent = this.agents.get(id);\n    if (!agent) return false;\n\n    try {\n      await agent.sandbox.close();\n      agent.status = 'terminated';\n      this.agents.delete(id);\n      logger.info('E2B agent terminated', { id });\n      return true;\n    } catch (error) {\n      logger.error('Error terminating agent', { id, error: (error as Error).message });\n      return false;\n    }\n  }\n\n  /**\n   * Shutdown the swarm\n   */\n  async shutdown(): Promise<void> {\n    this.isRunning = false;\n\n    const terminatePromises = Array.from(this.agents.keys()).map(id =>\n      this.terminateAgent(id)\n    );\n\n    await Promise.allSettled(terminatePromises);\n    this.agents.clear();\n    this.taskResults.clear();\n\n    logger.info('E2B Swarm shutdown complete');\n  }\n\n  /**\n   * Health check\n   */\n  async healthCheck(): Promise<{\n    healthy: boolean;\n    agents: Array<{ id: string; status: string; healthy: boolean }>;\n  }> {\n    const agentHealth = await Promise.all(\n      Array.from(this.agents.values()).map(async (agent) => {\n        let healthy = agent.status === 'ready' || agent.status === 'busy';\n\n        // Quick ping test\n        if (healthy && agent.status === 'ready') {\n          try {\n            const result = await agent.sandbox.runCommand('echo', ['ping']);\n            healthy = result.success;\n          } catch {\n            healthy = false;\n          }\n        }\n\n        return { id: agent.id, status: agent.status, healthy };\n      })\n    );\n\n    return {\n      healthy: agentHealth.every(a => a.healthy),\n      agents: agentHealth\n    };\n  }\n}\n\n/**\n * Create default swarm with standard agent types\n */\nexport async function createDefaultE2BSwarm(): Promise<E2BSwarmOrchestrator> {\n  const swarm = new E2BSwarmOrchestrator({\n    maxAgents: 8,\n    loadBalancing: 'capability-match'\n  });\n\n  await swarm.initialize();\n\n  const defaultAgents: E2BAgentConfig[] = [\n    { id: 'python-1', name: 'Python Executor', capability: 'python-executor', packages: ['numpy', 'pandas'] },\n    { id: 'js-1', name: 'JavaScript Executor', capability: 'javascript-executor' },\n    { id: 'shell-1', name: 'Shell Executor', capability: 'shell-executor' },\n    { id: 'data-1', name: 'Data Analyst', capability: 'data-analyst', packages: ['numpy', 'pandas', 'matplotlib'] },\n    { id: 'test-1', name: 'Test Runner', capability: 'test-runner' },\n    { id: 'security-1', name: 'Security Scanner', capability: 'security-scanner' }\n  ];\n\n  await swarm.spawnAgents(defaultAgents);\n\n  return swarm;\n}\n\n/**\n * Quick helper to run code in E2B swarm\n */\nexport async function runInSwarm(\n  swarm: E2BSwarmOrchestrator,\n  code: string,\n  type: 'python' | 'javascript' | 'shell' = 'python'\n): Promise<E2BTaskResult> {\n  return swarm.executeTask({\n    id: `task-${Date.now()}`,\n    type,\n    code\n  });\n}\n"]}