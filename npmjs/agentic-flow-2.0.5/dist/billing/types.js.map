{"version":3,"file":"types.js","sourceRoot":"","sources":["../../src/billing/types.ts"],"names":[],"mappings":"AAAA;;;GAGG;AAEH,qBAAqB;AACrB,MAAM,CAAN,IAAY,gBAMX;AAND,WAAY,gBAAgB;IAC1B,iCAAa,CAAA;IACb,uCAAmB,CAAA;IACnB,+BAAW,CAAA;IACX,6CAAyB,CAAA;IACzB,qCAAiB,CAAA;AACnB,CAAC,EANW,gBAAgB,KAAhB,gBAAgB,QAM3B;AAED,MAAM,CAAN,IAAY,YAIX;AAJD,WAAY,YAAY;IACtB,mCAAmB,CAAA;IACnB,iCAAiB,CAAA;IACjB,uCAAuB,CAAA;AACzB,CAAC,EAJW,YAAY,KAAZ,YAAY,QAIvB;AAED,MAAM,CAAN,IAAY,kBAMX;AAND,WAAY,kBAAkB;IAC5B,uCAAiB,CAAA;IACjB,2CAAqB,CAAA;IACrB,0CAAoB,CAAA;IACpB,2CAAqB,CAAA;IACrB,6CAAuB,CAAA;AACzB,CAAC,EANW,kBAAkB,KAAlB,kBAAkB,QAM7B;AAgDD,gBAAgB;AAChB,MAAM,CAAN,IAAY,WAWX;AAXD,WAAY,WAAW;IACrB,yCAA0B,CAAA;IAC1B,0CAA2B,CAAA;IAC3B,2CAA4B,CAAA;IAC5B,uCAAwB,CAAA;IACxB,uCAAwB,CAAA;IACxB,qCAAsB,CAAA;IACtB,2CAA4B,CAAA;IAC5B,iDAAkC,CAAA;IAClC,2CAA4B,CAAA;IAC5B,+CAAgC,CAAA;AAClC,CAAC,EAXW,WAAW,KAAX,WAAW,QAWtB;AA2BD,SAAS;AACT,MAAM,CAAN,IAAY,UAIX;AAJD,WAAY,UAAU;IACpB,uCAAyB,CAAA;IACzB,6BAAe,CAAA;IACf,+BAAiB,CAAA;AACnB,CAAC,EAJW,UAAU,KAAV,UAAU,QAIrB;AA6BD,UAAU;AACV,MAAM,CAAN,IAAY,eAIX;AAJD,WAAY,eAAe;IACzB,oCAAiB,CAAA;IACjB,oCAAiB,CAAA;IACjB,oCAAiB,CAAA;AACnB,CAAC,EAJW,eAAe,KAAf,eAAe,QAI1B;AAED,MAAM,CAAN,IAAY,aAMX;AAND,WAAY,aAAa;IACvB,oCAAmB,CAAA;IACnB,wCAAuB,CAAA;IACvB,kCAAiB,CAAA;IACjB,sCAAqB,CAAA;IACrB,sCAAqB,CAAA;AACvB,CAAC,EANW,aAAa,KAAb,aAAa,QAMxB;AA4ED,SAAS;AACT,MAAM,CAAN,IAAY,gBAWX;AAXD,WAAY,gBAAgB;IAC1B,gEAA4C,CAAA;IAC5C,gEAA4C,CAAA;IAC5C,kEAA8C,CAAA;IAC9C,gEAA4C,CAAA;IAC5C,oDAAgC,CAAA;IAChC,oDAAgC,CAAA;IAChC,0DAAsC,CAAA;IACtC,oDAAgC,CAAA;IAChC,sDAAkC,CAAA;IAClC,oDAAgC,CAAA;AAClC,CAAC,EAXW,gBAAgB,KAAhB,gBAAgB,QAW3B","sourcesContent":["/**\n * Core TypeScript types for the Economic System\n * Native npm implementation for agentic-jujutsu\n */\n\n// Subscription Tiers\nexport enum SubscriptionTier {\n  Free = 'free',\n  Starter = 'starter',\n  Pro = 'pro',\n  Enterprise = 'enterprise',\n  Custom = 'custom'\n}\n\nexport enum BillingCycle {\n  Monthly = 'monthly',\n  Yearly = 'yearly',\n  Quarterly = 'quarterly'\n}\n\nexport enum SubscriptionStatus {\n  Active = 'active',\n  Canceled = 'canceled',\n  PastDue = 'past_due',\n  Trialing = 'trialing',\n  Suspended = 'suspended'\n}\n\n// Subscription\nexport interface Subscription {\n  id: string;\n  userId: string;\n  tier: SubscriptionTier;\n  billingCycle: BillingCycle;\n  status: SubscriptionStatus;\n  price: number;\n  currency: string;\n  limits: UsageLimits;\n  currentPeriodStart: Date;\n  currentPeriodEnd: Date;\n  cancelAtPeriodEnd: boolean;\n  paymentMethodId?: string;\n  metadata?: Record<string, any>;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\n// Usage Limits\nexport interface UsageLimits {\n  maxAgentHours: number;\n  maxDeployments: number;\n  maxAPIRequests: number;\n  maxStorageGB: number;\n  maxSwarmSize: number;\n  maxGPUHours: number;\n  maxBandwidthGB: number;\n  maxConcurrentJobs: number;\n  maxTeamMembers: number;\n  maxCustomDomains: number;\n}\n\n// Pricing Tier\nexport interface PricingTier {\n  tier: SubscriptionTier;\n  name: string;\n  description: string;\n  monthlyPrice: number;\n  yearlyPrice: number;\n  quarterlyPrice: number;\n  limits: UsageLimits;\n  features: string[];\n  popular?: boolean;\n}\n\n// Usage Metrics\nexport enum UsageMetric {\n  AgentHours = 'agent_hours',\n  Deployments = 'deployments',\n  APIRequests = 'api_requests',\n  StorageGB = 'storage_gb',\n  SwarmSize = 'swarm_size',\n  GPUHours = 'gpu_hours',\n  BandwidthGB = 'bandwidth_gb',\n  ConcurrentJobs = 'concurrent_jobs',\n  TeamMembers = 'team_members',\n  CustomDomains = 'custom_domains'\n}\n\n// Usage Record\nexport interface UsageRecord {\n  id: string;\n  subscriptionId: string;\n  userId: string;\n  metric: UsageMetric;\n  amount: number;\n  unit: string;\n  timestamp: Date;\n  billingPeriod: string;\n  metadata?: Record<string, any>;\n}\n\n// Usage Summary\nexport interface UsageSummary {\n  subscriptionId: string;\n  userId: string;\n  period: string;\n  metrics: Map<UsageMetric, number>;\n  limits: UsageLimits;\n  percentUsed: Map<UsageMetric, number>;\n  overages: Map<UsageMetric, number>;\n  estimatedCost: number;\n}\n\n// Coupon\nexport enum CouponType {\n  Percentage = 'percentage',\n  Fixed = 'fixed',\n  Credit = 'credit'\n}\n\nexport interface Coupon {\n  id: string;\n  code: string;\n  type: CouponType;\n  value: number;\n  currency?: string;\n  description?: string;\n  maxRedemptions?: number;\n  timesRedeemed: number;\n  validFrom: Date;\n  validUntil?: Date;\n  applicableTiers?: SubscriptionTier[];\n  minimumAmount?: number;\n  metadata?: Record<string, any>;\n  active: boolean;\n  createdAt: Date;\n}\n\n// Coupon Validation\nexport interface CouponValidation {\n  valid: boolean;\n  coupon?: Coupon;\n  discountAmount: number;\n  finalAmount: number;\n  error?: string;\n}\n\n// Payment\nexport enum PaymentProvider {\n  Stripe = 'stripe',\n  PayPal = 'paypal',\n  Crypto = 'crypto'\n}\n\nexport enum PaymentStatus {\n  Pending = 'pending',\n  Succeeded = 'succeeded',\n  Failed = 'failed',\n  Refunded = 'refunded',\n  Canceled = 'canceled'\n}\n\nexport interface PaymentMethod {\n  id: string;\n  userId: string;\n  provider: PaymentProvider;\n  type: string; // 'card', 'bank_account', 'crypto_wallet'\n  last4?: string;\n  expiryMonth?: number;\n  expiryYear?: number;\n  brand?: string;\n  isDefault: boolean;\n  metadata?: Record<string, any>;\n}\n\nexport interface PaymentRequest {\n  subscriptionId: string;\n  userId: string;\n  amount: number;\n  currency: string;\n  paymentMethodId: string;\n  description?: string;\n  metadata?: Record<string, any>;\n}\n\nexport interface PaymentResult {\n  transactionId: string;\n  status: PaymentStatus;\n  amount: number;\n  currency: string;\n  providerTransactionId?: string;\n  error?: string;\n  processedAt: Date;\n}\n\n// Invoice\nexport interface Invoice {\n  id: string;\n  subscriptionId: string;\n  userId: string;\n  amount: number;\n  currency: string;\n  status: PaymentStatus;\n  periodStart: Date;\n  periodEnd: Date;\n  lineItems: InvoiceLineItem[];\n  subtotal: number;\n  discount: number;\n  tax: number;\n  total: number;\n  paidAt?: Date;\n  dueDate: Date;\n  metadata?: Record<string, any>;\n  createdAt: Date;\n}\n\nexport interface InvoiceLineItem {\n  description: string;\n  amount: number;\n  quantity: number;\n  unitPrice: number;\n  metadata?: Record<string, any>;\n}\n\n// Quota Check Result\nexport interface QuotaCheckResult {\n  allowed: boolean;\n  metric: UsageMetric;\n  current: number;\n  limit: number;\n  percentUsed: number;\n  remaining: number;\n  overage: number;\n  warning?: string;\n}\n\n// Events\nexport enum BillingEventType {\n  SubscriptionCreated = 'subscription.created',\n  SubscriptionUpdated = 'subscription.updated',\n  SubscriptionCanceled = 'subscription.canceled',\n  SubscriptionRenewed = 'subscription.renewed',\n  UsageRecorded = 'usage.recorded',\n  QuotaExceeded = 'quota.exceeded',\n  PaymentSucceeded = 'payment.succeeded',\n  PaymentFailed = 'payment.failed',\n  InvoiceCreated = 'invoice.created',\n  CouponApplied = 'coupon.applied'\n}\n\nexport interface BillingEvent {\n  id: string;\n  type: BillingEventType;\n  timestamp: Date;\n  data: any;\n  userId: string;\n  subscriptionId?: string;\n}\n\n// Configuration\nexport interface BillingConfig {\n  currency: string;\n  taxRate: number;\n  gracePeriodDays: number;\n  enableMetering: boolean;\n  enableCoupons: boolean;\n  enableOverages: boolean;\n  overageRate: number;\n  softLimitPercent: number;\n  hardLimitPercent: number;\n  storageBackend: 'memory' | 'agentdb' | 'sqlite' | 'postgres';\n  paymentProvider: PaymentProvider;\n}\n\n// Storage Adapter Interface\nexport interface StorageAdapter {\n  // Subscriptions\n  saveSubscription(subscription: Subscription): Promise<void>;\n  getSubscription(id: string): Promise<Subscription | null>;\n  updateSubscription(subscription: Subscription): Promise<void>;\n  deleteSubscription(id: string): Promise<void>;\n  listSubscriptions(userId: string): Promise<Subscription[]>;\n\n  // Usage\n  saveUsageRecord(record: UsageRecord): Promise<void>;\n  getUsageRecords(subscriptionId: string, period: string): Promise<UsageRecord[]>;\n\n  // Coupons\n  saveCoupon(coupon: Coupon): Promise<void>;\n  getCoupon(code: string): Promise<Coupon | null>;\n  updateCoupon(coupon: Coupon): Promise<void>;\n  listCoupons(): Promise<Coupon[]>;\n\n  // Invoices\n  saveInvoice(invoice: Invoice): Promise<void>;\n  getInvoice(id: string): Promise<Invoice | null>;\n  listInvoices(userId: string): Promise<Invoice[]>;\n\n  // Events\n  saveEvent(event: BillingEvent): Promise<void>;\n  getEvents(userId: string, type?: BillingEventType): Promise<BillingEvent[]>;\n}\n"]}