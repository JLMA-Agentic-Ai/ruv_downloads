{"version":3,"file":"swarm.js","sourceRoot":"","sources":["../../../src/cli/commands/swarm.ts"],"names":[],"mappings":"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","sourcesContent":["#!/usr/bin/env node\n/**\n * P2P Swarm V2 CLI Commands\n *\n * Production-grade P2P swarm coordination with:\n * - Ed25519/X25519 cryptography\n * - GunDB relay coordination\n * - Task execution with claim resolution\n * - Heartbeat-based liveness\n * - Verified member registry\n */\n\nimport { Command } from 'commander';\nimport { P2PSwarmV2, createP2PSwarmV2 } from '../../swarm/p2p-swarm-v2.js';\nimport { logger } from '../../utils/logger.js';\n\n// Global swarm instance\nlet swarmInstance: P2PSwarmV2 | null = null;\n\nexport function createSwarmCommand(): Command {\n  const swarm = new Command('swarm')\n    .description('P2P Swarm V2 - Production-grade decentralized coordination');\n\n  // Initialize and connect to swarm\n  swarm\n    .command('connect')\n    .description('Connect to a P2P swarm')\n    .option('-a, --agent-id <id>', 'Agent ID (default: auto-generated)')\n    .option('-k, --swarm-key <key>', 'Swarm key for joining existing swarm')\n    .option('-e, --executor', 'Enable task executor capability')\n    .option('-j, --json', 'Output as JSON')\n    .action(async (options: {\n      agentId?: string;\n      swarmKey?: string;\n      executor?: boolean;\n      json?: boolean;\n    }) => {\n      try {\n        const agentId = options.agentId || `agent-${Date.now().toString(36)}`;\n\n        console.log(`Connecting to P2P Swarm...`);\n        swarmInstance = await createP2PSwarmV2(agentId, options.swarmKey);\n\n        if (options.executor) {\n          swarmInstance.startTaskExecutor();\n        }\n\n        const status = swarmInstance.getStatus();\n\n        if (options.json) {\n          console.log(JSON.stringify({\n            connected: status.connected,\n            agentId: status.agentId,\n            swarmId: status.swarmId,\n            swarmKey: swarmInstance.getSwarmKey(),\n            relays: status.relays,\n            executor: options.executor || false,\n          }, null, 2));\n        } else {\n          console.log(`\\nâœ… Connected to P2P Swarm V2`);\n          console.log(`   Agent ID:  ${status.agentId}`);\n          console.log(`   Swarm ID:  ${status.swarmId}`);\n          console.log(`   Swarm Key: ${swarmInstance.getSwarmKey().slice(0, 20)}...`);\n          console.log(`   Relays:    ${status.relays.healthy}/${status.relays.total} healthy`);\n          console.log(`   Executor:  ${options.executor ? 'Enabled' : 'Disabled'}`);\n          console.log(`\\nShare the swarm key to invite others:`);\n          console.log(`   npx agentic-flow@alpha swarm connect -k \"${swarmInstance.getSwarmKey()}\"`);\n        }\n\n        // Keep process alive for background operations\n        if (options.executor) {\n          console.log(`\\nTask executor running. Press Ctrl+C to stop.`);\n          process.on('SIGINT', () => {\n            swarmInstance?.disconnect();\n            process.exit(0);\n          });\n          // Keep alive\n          await new Promise(() => {});\n        }\n      } catch (error) {\n        console.error('Error:', error instanceof Error ? error.message : error);\n        process.exit(1);\n      }\n    });\n\n  // Get swarm status\n  swarm\n    .command('status')\n    .description('Get current swarm status')\n    .option('-j, --json', 'Output as JSON')\n    .action(async (options: { json?: boolean }) => {\n      if (!swarmInstance) {\n        console.error('Not connected to swarm. Run: swarm connect');\n        process.exit(1);\n      }\n\n      const status = swarmInstance.getStatus();\n      const liveMembers = swarmInstance.getLiveMembers();\n\n      if (options.json) {\n        console.log(JSON.stringify({\n          ...status,\n          liveMembers,\n          liveMemberCount: swarmInstance.getLiveMemberCount(),\n        }, null, 2));\n      } else {\n        console.log(`\\nðŸ“Š P2P Swarm Status`);\n        console.log(`   Connected:    ${status.connected}`);\n        console.log(`   Agent ID:     ${status.agentId}`);\n        console.log(`   Swarm ID:     ${status.swarmId}`);\n        console.log(`   Relays:       ${status.relays.healthy}/${status.relays.total} healthy`);\n        console.log(`   Avg Latency:  ${status.relays.avgLatency.toFixed(0)}ms`);\n        console.log(`\\nðŸ‘¥ Live Members: ${swarmInstance.getLiveMemberCount()}`);\n        for (const member of liveMembers) {\n          const status = member.isAlive ? 'ðŸŸ¢' : 'ðŸ”´';\n          const age = Math.round((Date.now() - member.lastSeen) / 1000);\n          console.log(`   ${status} ${member.agentId} (${member.capabilities.join(', ')}) - ${age}s ago`);\n        }\n      }\n    });\n\n  // List members\n  swarm\n    .command('members')\n    .description('List swarm members')\n    .option('-a, --all', 'Include offline members')\n    .option('-j, --json', 'Output as JSON')\n    .action(async (options: { all?: boolean; json?: boolean }) => {\n      if (!swarmInstance) {\n        console.error('Not connected to swarm. Run: swarm connect');\n        process.exit(1);\n      }\n\n      const members = swarmInstance.getLiveMembers();\n      const filtered = options.all ? members : members.filter(m => m.isAlive);\n\n      if (options.json) {\n        console.log(JSON.stringify(filtered, null, 2));\n      } else {\n        console.log(`\\nðŸ‘¥ Swarm Members (${filtered.length})`);\n        for (const member of filtered) {\n          const status = member.isAlive ? 'ðŸŸ¢ Online' : 'ðŸ”´ Offline';\n          const age = Math.round((Date.now() - member.lastSeen) / 1000);\n          console.log(`\\n   ${member.agentId}`);\n          console.log(`   Status:       ${status}`);\n          console.log(`   Capabilities: ${member.capabilities.join(', ')}`);\n          console.log(`   Last Seen:    ${age}s ago`);\n        }\n      }\n    });\n\n  // Publish message to topic\n  swarm\n    .command('publish <topic> <message>')\n    .description('Publish a message to a topic')\n    .option('-j, --json', 'Parse message as JSON')\n    .action(async (topic: string, message: string, options: { json?: boolean }) => {\n      if (!swarmInstance) {\n        console.error('Not connected to swarm. Run: swarm connect');\n        process.exit(1);\n      }\n\n      try {\n        const payload = options.json ? JSON.parse(message) : { text: message };\n        const messageId = await swarmInstance.publish(topic, payload);\n        console.log(`âœ… Published to ${topic}`);\n        console.log(`   Message ID: ${messageId}`);\n      } catch (error) {\n        console.error('Error:', error instanceof Error ? error.message : error);\n        process.exit(1);\n      }\n    });\n\n  // Subscribe to topic\n  swarm\n    .command('subscribe <topic>')\n    .description('Subscribe to a topic and print messages')\n    .action(async (topic: string) => {\n      if (!swarmInstance) {\n        console.error('Not connected to swarm. Run: swarm connect');\n        process.exit(1);\n      }\n\n      console.log(`ðŸ“¡ Subscribed to ${topic}. Waiting for messages...`);\n      swarmInstance.subscribe(topic, (data, from) => {\n        console.log(`\\n[${new Date().toISOString()}] From: ${from}`);\n        console.log(JSON.stringify(data, null, 2));\n      });\n\n      // Keep alive\n      process.on('SIGINT', () => {\n        swarmInstance?.disconnect();\n        process.exit(0);\n      });\n      await new Promise(() => {});\n    });\n\n  // Sync Q-table\n  swarm\n    .command('sync-qtable')\n    .description('Sync a Q-table to the swarm')\n    .requiredOption('-f, --file <path>', 'Path to Q-table JSON file')\n    .action(async (options: { file: string }) => {\n      if (!swarmInstance) {\n        console.error('Not connected to swarm. Run: swarm connect');\n        process.exit(1);\n      }\n\n      try {\n        const fs = await import('fs');\n        const data = fs.readFileSync(options.file, 'utf-8');\n        const qTable = JSON.parse(data);\n\n        if (!Array.isArray(qTable) || !Array.isArray(qTable[0])) {\n          throw new Error('Q-table must be a 2D array');\n        }\n\n        const pointer = await swarmInstance.syncQTable(qTable);\n        console.log(`âœ… Q-table synced`);\n        console.log(`   CID:        ${pointer.cid}`);\n        console.log(`   Dimensions: ${pointer.dimensions}`);\n        console.log(`   Checksum:   ${pointer.checksum}`);\n      } catch (error) {\n        console.error('Error:', error instanceof Error ? error.message : error);\n        process.exit(1);\n      }\n    });\n\n  // Sync memory vectors\n  swarm\n    .command('sync-memory')\n    .description('Sync memory vectors to the swarm')\n    .requiredOption('-f, --file <path>', 'Path to vectors JSON file')\n    .option('-n, --namespace <ns>', 'Memory namespace', 'default')\n    .action(async (options: { file: string; namespace: string }) => {\n      if (!swarmInstance) {\n        console.error('Not connected to swarm. Run: swarm connect');\n        process.exit(1);\n      }\n\n      try {\n        const fs = await import('fs');\n        const data = fs.readFileSync(options.file, 'utf-8');\n        const vectors = JSON.parse(data);\n\n        if (!Array.isArray(vectors) || !Array.isArray(vectors[0])) {\n          throw new Error('Vectors must be a 2D array');\n        }\n\n        const pointer = await swarmInstance.syncMemory(vectors, options.namespace);\n        console.log(`âœ… Memory vectors synced`);\n        console.log(`   CID:        ${pointer.cid}`);\n        console.log(`   Namespace:  ${options.namespace}`);\n        console.log(`   Dimensions: ${pointer.dimensions}`);\n      } catch (error) {\n        console.error('Error:', error instanceof Error ? error.message : error);\n        process.exit(1);\n      }\n    });\n\n  // Submit task\n  swarm\n    .command('submit-task')\n    .description('Submit a task for execution')\n    .requiredOption('-m, --module <cid>', 'WASM module CID')\n    .requiredOption('-i, --input <cid>', 'Input data CID')\n    .option('-e, --entrypoint <fn>', 'Entrypoint function', 'main')\n    .option('-f, --fuel <n>', 'Fuel limit', '1000000')\n    .option('-M, --memory <mb>', 'Memory limit in MB', '64')\n    .option('-t, --timeout <ms>', 'Timeout in ms', '30000')\n    .action(async (options: {\n      module: string;\n      input: string;\n      entrypoint: string;\n      fuel: string;\n      memory: string;\n      timeout: string;\n    }) => {\n      if (!swarmInstance) {\n        console.error('Not connected to swarm. Run: swarm connect');\n        process.exit(1);\n      }\n\n      try {\n        const taskId = await swarmInstance.submitTask({\n          taskId: `task-${Date.now().toString(36)}`,\n          moduleCID: options.module,\n          inputCID: options.input,\n          entrypoint: options.entrypoint,\n          outputSchemaHash: '',\n          budgets: {\n            fuelLimit: parseInt(options.fuel),\n            memoryMB: parseInt(options.memory),\n            timeoutMs: parseInt(options.timeout),\n          },\n        });\n\n        console.log(`âœ… Task submitted`);\n        console.log(`   Message ID: ${taskId}`);\n        console.log(`   Module:     ${options.module}`);\n        console.log(`   Input:      ${options.input}`);\n      } catch (error) {\n        console.error('Error:', error instanceof Error ? error.message : error);\n        process.exit(1);\n      }\n    });\n\n  // Start executor\n  swarm\n    .command('executor')\n    .description('Start task executor daemon')\n    .action(async () => {\n      if (!swarmInstance) {\n        console.error('Not connected to swarm. Run: swarm connect');\n        process.exit(1);\n      }\n\n      swarmInstance.startTaskExecutor();\n      console.log(`âœ… Task executor started`);\n      console.log(`   Listening for tasks...`);\n\n      process.on('SIGINT', () => {\n        swarmInstance?.stopTaskExecutor();\n        swarmInstance?.disconnect();\n        process.exit(0);\n      });\n      await new Promise(() => {});\n    });\n\n  // Disconnect\n  swarm\n    .command('disconnect')\n    .description('Disconnect from the swarm')\n    .action(async () => {\n      if (swarmInstance) {\n        swarmInstance.disconnect();\n        swarmInstance = null;\n        console.log('âœ… Disconnected from swarm');\n      } else {\n        console.log('Not connected to swarm');\n      }\n    });\n\n  // Generate new swarm key\n  swarm\n    .command('keygen')\n    .description('Generate a new swarm key')\n    .action(async () => {\n      const crypto = await import('crypto');\n      const key = crypto.randomBytes(32).toString('base64');\n      console.log(`ðŸ”‘ New Swarm Key:`);\n      console.log(`   ${key}`);\n      console.log(`\\nUse with:`);\n      console.log(`   npx agentic-flow@alpha swarm connect -k \"${key}\"`);\n    });\n\n  return swarm;\n}\n\n// Export singleton getter for hooks/MCP integration\nexport function getSwarmInstance(): P2PSwarmV2 | null {\n  return swarmInstance;\n}\n\nexport function setSwarmInstance(instance: P2PSwarmV2): void {\n  swarmInstance = instance;\n}\n"]}