{"version":3,"file":"p2p-swarm-tools.js","sourceRoot":"","sources":["../../../../../src/mcp/fastmcp/tools/swarm/p2p-swarm-tools.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * P2P Swarm V2 MCP Tools\n *\n * Production-grade P2P swarm coordination exposed as MCP tools.\n * Provides decentralized coordination, task execution, and learning sync.\n *\n * Features:\n * - Ed25519/X25519 cryptography\n * - GunDB relay coordination\n * - Task execution with claim resolution\n * - Heartbeat-based liveness\n * - Verified member registry\n */\n\nimport { z } from 'zod';\nimport { P2PSwarmV2, createP2PSwarmV2 } from '../../../../swarm/p2p-swarm-v2.js';\nimport { logger } from '../../../../utils/logger.js';\n\n// Global swarm instance for MCP tools\nlet swarmInstance: P2PSwarmV2 | null = null;\n\n/**\n * Get or create swarm instance\n */\nasync function getSwarm(agentId?: string, swarmKey?: string): Promise<P2PSwarmV2> {\n  if (!swarmInstance) {\n    const id = agentId || `mcp-agent-${Date.now().toString(36)}`;\n    swarmInstance = await createP2PSwarmV2(id, swarmKey);\n  }\n  return swarmInstance;\n}\n\n/**\n * P2P Swarm Connect Tool\n */\nexport const p2pSwarmConnectTool = {\n  name: 'p2p_swarm_connect',\n  description: 'Connect to a P2P swarm for decentralized coordination',\n  schema: z.object({\n    agentId: z.string().optional().describe('Agent ID (auto-generated if not provided)'),\n    swarmKey: z.string().optional().describe('Swarm key to join existing swarm'),\n    enableExecutor: z.boolean().optional().default(false).describe('Enable task executor'),\n  }),\n  execute: async (params: {\n    agentId?: string;\n    swarmKey?: string;\n    enableExecutor?: boolean;\n  }) => {\n    try {\n      const swarm = await getSwarm(params.agentId, params.swarmKey);\n\n      if (params.enableExecutor) {\n        swarm.startTaskExecutor();\n      }\n\n      const status = swarm.getStatus();\n\n      return {\n        success: true,\n        connected: status.connected,\n        agentId: status.agentId,\n        swarmId: status.swarmId,\n        swarmKey: swarm.getSwarmKey(),\n        relays: status.relays,\n        executorEnabled: params.enableExecutor || false,\n      };\n    } catch (error) {\n      logger.error('Failed to connect to swarm', { error });\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : String(error),\n      };\n    }\n  },\n};\n\n/**\n * P2P Swarm Status Tool\n */\nexport const p2pSwarmStatusTool = {\n  name: 'p2p_swarm_status',\n  description: 'Get current P2P swarm status including live members',\n  schema: z.object({}),\n  execute: async () => {\n    if (!swarmInstance) {\n      return {\n        success: false,\n        error: 'Not connected to swarm. Use p2p_swarm_connect first.',\n      };\n    }\n\n    const status = swarmInstance.getStatus();\n    const liveMembers = swarmInstance.getLiveMembers();\n\n    return {\n      success: true,\n      ...status,\n      liveMembers,\n      liveMemberCount: swarmInstance.getLiveMemberCount(),\n    };\n  },\n};\n\n/**\n * P2P Swarm Members Tool\n */\nexport const p2pSwarmMembersTool = {\n  name: 'p2p_swarm_members',\n  description: 'List swarm members with their capabilities and liveness',\n  schema: z.object({\n    includeOffline: z.boolean().optional().default(false).describe('Include offline members'),\n  }),\n  execute: async (params: { includeOffline?: boolean }) => {\n    if (!swarmInstance) {\n      return {\n        success: false,\n        error: 'Not connected to swarm. Use p2p_swarm_connect first.',\n      };\n    }\n\n    const members = swarmInstance.getLiveMembers();\n    const filtered = params.includeOffline ? members : members.filter(m => m.isAlive);\n\n    return {\n      success: true,\n      count: filtered.length,\n      liveCount: filtered.filter(m => m.isAlive).length,\n      members: filtered.map(m => ({\n        agentId: m.agentId,\n        capabilities: m.capabilities,\n        isAlive: m.isAlive,\n        lastSeenAgo: Math.round((Date.now() - m.lastSeen) / 1000),\n      })),\n    };\n  },\n};\n\n/**\n * P2P Swarm Publish Tool\n */\nexport const p2pSwarmPublishTool = {\n  name: 'p2p_swarm_publish',\n  description: 'Publish a signed and encrypted message to a swarm topic',\n  schema: z.object({\n    topic: z.string().describe('Topic to publish to'),\n    payload: z.any().describe('Message payload (will be JSON serialized)'),\n  }),\n  execute: async (params: { topic: string; payload: any }) => {\n    if (!swarmInstance) {\n      return {\n        success: false,\n        error: 'Not connected to swarm. Use p2p_swarm_connect first.',\n      };\n    }\n\n    try {\n      const messageId = await swarmInstance.publish(params.topic, params.payload);\n      return {\n        success: true,\n        messageId,\n        topic: params.topic,\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : String(error),\n      };\n    }\n  },\n};\n\n/**\n * P2P Swarm Subscribe Tool\n */\nexport const p2pSwarmSubscribeTool = {\n  name: 'p2p_swarm_subscribe',\n  description: 'Subscribe to a swarm topic (messages delivered via callback)',\n  schema: z.object({\n    topic: z.string().describe('Topic to subscribe to'),\n  }),\n  execute: async (params: { topic: string }) => {\n    if (!swarmInstance) {\n      return {\n        success: false,\n        error: 'Not connected to swarm. Use p2p_swarm_connect first.',\n      };\n    }\n\n    // Note: In MCP context, we return success but messages are handled internally\n    // For real-time messages, use the streaming MCP transport\n    swarmInstance.subscribe(params.topic, (data, from) => {\n      logger.info('Swarm message received', { topic: params.topic, from, data });\n    });\n\n    return {\n      success: true,\n      subscribed: params.topic,\n      note: 'Messages will be logged. Use streaming transport for real-time delivery.',\n    };\n  },\n};\n\n/**\n * P2P Swarm Sync Q-Table Tool\n */\nexport const p2pSwarmSyncQTableTool = {\n  name: 'p2p_swarm_sync_qtable',\n  description: 'Sync a Q-table to the swarm for distributed learning',\n  schema: z.object({\n    qTable: z.array(z.array(z.number())).describe('2D array Q-table'),\n  }),\n  execute: async (params: { qTable: number[][] }) => {\n    if (!swarmInstance) {\n      return {\n        success: false,\n        error: 'Not connected to swarm. Use p2p_swarm_connect first.',\n      };\n    }\n\n    try {\n      const pointer = await swarmInstance.syncQTable(params.qTable);\n      return {\n        success: true,\n        cid: pointer.cid,\n        dimensions: pointer.dimensions,\n        checksum: pointer.checksum,\n        timestamp: pointer.timestamp,\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : String(error),\n      };\n    }\n  },\n};\n\n/**\n * P2P Swarm Sync Memory Tool\n */\nexport const p2pSwarmSyncMemoryTool = {\n  name: 'p2p_swarm_sync_memory',\n  description: 'Sync memory vectors to the swarm',\n  schema: z.object({\n    vectors: z.array(z.array(z.number())).describe('2D array of vectors'),\n    namespace: z.string().optional().default('default').describe('Memory namespace'),\n  }),\n  execute: async (params: { vectors: number[][]; namespace?: string }) => {\n    if (!swarmInstance) {\n      return {\n        success: false,\n        error: 'Not connected to swarm. Use p2p_swarm_connect first.',\n      };\n    }\n\n    try {\n      const pointer = await swarmInstance.syncMemory(params.vectors, params.namespace || 'default');\n      return {\n        success: true,\n        cid: pointer.cid,\n        namespace: params.namespace || 'default',\n        dimensions: pointer.dimensions,\n        checksum: pointer.checksum,\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : String(error),\n      };\n    }\n  },\n};\n\n/**\n * P2P Swarm Submit Task Tool\n */\nexport const p2pSwarmSubmitTaskTool = {\n  name: 'p2p_swarm_submit_task',\n  description: 'Submit a task for distributed execution',\n  schema: z.object({\n    moduleCID: z.string().describe('CID of WASM module'),\n    inputCID: z.string().describe('CID of input data'),\n    entrypoint: z.string().optional().default('main').describe('Entrypoint function'),\n    fuelLimit: z.number().optional().default(1000000).describe('Fuel limit'),\n    memoryMB: z.number().optional().default(64).describe('Memory limit in MB'),\n    timeoutMs: z.number().optional().default(30000).describe('Timeout in ms'),\n  }),\n  execute: async (params: {\n    moduleCID: string;\n    inputCID: string;\n    entrypoint?: string;\n    fuelLimit?: number;\n    memoryMB?: number;\n    timeoutMs?: number;\n  }) => {\n    if (!swarmInstance) {\n      return {\n        success: false,\n        error: 'Not connected to swarm. Use p2p_swarm_connect first.',\n      };\n    }\n\n    try {\n      const taskId = `task-${Date.now().toString(36)}`;\n      const messageId = await swarmInstance.submitTask({\n        taskId,\n        moduleCID: params.moduleCID,\n        inputCID: params.inputCID,\n        entrypoint: params.entrypoint || 'main',\n        outputSchemaHash: '',\n        budgets: {\n          fuelLimit: params.fuelLimit || 1000000,\n          memoryMB: params.memoryMB || 64,\n          timeoutMs: params.timeoutMs || 30000,\n        },\n      });\n\n      return {\n        success: true,\n        taskId,\n        messageId,\n        moduleCID: params.moduleCID,\n        inputCID: params.inputCID,\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : String(error),\n      };\n    }\n  },\n};\n\n/**\n * P2P Swarm Start Executor Tool\n */\nexport const p2pSwarmStartExecutorTool = {\n  name: 'p2p_swarm_start_executor',\n  description: 'Start the task executor to process distributed tasks',\n  schema: z.object({}),\n  execute: async () => {\n    if (!swarmInstance) {\n      return {\n        success: false,\n        error: 'Not connected to swarm. Use p2p_swarm_connect first.',\n      };\n    }\n\n    swarmInstance.startTaskExecutor();\n    return {\n      success: true,\n      message: 'Task executor started. Listening for tasks.',\n    };\n  },\n};\n\n/**\n * P2P Swarm Stop Executor Tool\n */\nexport const p2pSwarmStopExecutorTool = {\n  name: 'p2p_swarm_stop_executor',\n  description: 'Stop the task executor',\n  schema: z.object({}),\n  execute: async () => {\n    if (!swarmInstance) {\n      return {\n        success: false,\n        error: 'Not connected to swarm.',\n      };\n    }\n\n    swarmInstance.stopTaskExecutor();\n    return {\n      success: true,\n      message: 'Task executor stopped.',\n    };\n  },\n};\n\n/**\n * P2P Swarm Disconnect Tool\n */\nexport const p2pSwarmDisconnectTool = {\n  name: 'p2p_swarm_disconnect',\n  description: 'Disconnect from the P2P swarm',\n  schema: z.object({}),\n  execute: async () => {\n    if (swarmInstance) {\n      swarmInstance.disconnect();\n      swarmInstance = null;\n      return {\n        success: true,\n        message: 'Disconnected from swarm.',\n      };\n    }\n    return {\n      success: true,\n      message: 'Not connected to swarm.',\n    };\n  },\n};\n\n/**\n * P2P Swarm Keygen Tool\n */\nexport const p2pSwarmKeygenTool = {\n  name: 'p2p_swarm_keygen',\n  description: 'Generate a new swarm key for creating a new swarm',\n  schema: z.object({}),\n  execute: async () => {\n    const crypto = await import('crypto');\n    const key = crypto.randomBytes(32).toString('base64');\n    return {\n      success: true,\n      swarmKey: key,\n      usage: `Use with p2p_swarm_connect: { swarmKey: \"${key}\" }`,\n    };\n  },\n};\n\n// Export all tools as array for MCP registration\nexport const p2pSwarmTools = [\n  p2pSwarmConnectTool,\n  p2pSwarmStatusTool,\n  p2pSwarmMembersTool,\n  p2pSwarmPublishTool,\n  p2pSwarmSubscribeTool,\n  p2pSwarmSyncQTableTool,\n  p2pSwarmSyncMemoryTool,\n  p2pSwarmSubmitTaskTool,\n  p2pSwarmStartExecutorTool,\n  p2pSwarmStopExecutorTool,\n  p2pSwarmDisconnectTool,\n  p2pSwarmKeygenTool,\n];\n\n// Export singleton accessor\nexport function getP2PSwarmInstance(): P2PSwarmV2 | null {\n  return swarmInstance;\n}\n\nexport function setP2PSwarmInstance(instance: P2PSwarmV2): void {\n  swarmInstance = instance;\n}\n"]}