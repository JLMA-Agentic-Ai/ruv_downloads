{"version":3,"file":"gnn-wrapper.js","sourceRoot":"","sources":["../../src/core/gnn-wrapper.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * GNN Compatibility Wrapper\n *\n * Fixes API issues with @ruvector/gnn by:\n * 1. Auto-converting regular arrays to Float32Array\n * 2. Providing fallback implementations for broken functions\n * 3. Type-safe interface matching documentation\n */\n\n// Dynamic GNN import with graceful degradation\nconst gnn: any = await (async () => {\n  try {\n    const module = await import('@ruvector/gnn');\n    return module.default || module;\n  } catch {\n    return null;\n  }\n})();\n\nexport interface SearchResult {\n  indices: number[];\n  weights: number[];\n}\n\nexport interface CompressionConfig {\n  levelType: 'none' | 'half' | 'pq8' | 'pq4' | 'binary';\n  scale?: number;\n  subvectors?: number;\n  centroids?: number;\n  outlierThreshold?: number;\n  threshold?: number;\n}\n\n/**\n * Fixed differentiableSearch that accepts regular arrays\n * Automatically converts to Float32Array internally\n */\nexport function differentiableSearch(\n  query: number[],\n  candidateEmbeddings: number[][],\n  k: number,\n  temperature: number = 1.0\n): SearchResult {\n  // Convert to Float32Array\n  const queryTyped = new Float32Array(query);\n  const candidatesTyped = candidateEmbeddings.map(\n    candidate => new Float32Array(candidate)\n  );\n\n  try {\n    const result = gnn.differentiableSearch(queryTyped, candidatesTyped, k, temperature);\n\n    return {\n      indices: Array.from(result.indices),\n      weights: Array.from(result.weights)\n    };\n  } catch (error: any) {\n    throw new Error(`GNN differentiableSearch failed: ${error.message}`);\n  }\n}\n\n/**\n * Fallback hierarchicalForward using simple matrix multiplication\n * Since the native implementation is broken\n */\nexport function hierarchicalForward(\n  input: number[],\n  weights: number[] | number[][],\n  inputDim: number,\n  outputDim: number\n): number[] {\n  try {\n    // Try native implementation first\n    const inputTyped = new Float32Array(input);\n    const weightsTyped = Array.isArray(weights[0])\n      ? (weights as number[][]).map(w => new Float32Array(w))\n      : new Float32Array(weights as number[]);\n\n    const result = gnn.hierarchicalForward(inputTyped, weightsTyped, inputDim, outputDim);\n    return Array.from(result);\n  } catch (error) {\n    // Fallback to JavaScript implementation\n    console.warn('GNN hierarchicalForward failed, using fallback implementation');\n    return hierarchicalForwardFallback(input, weights, inputDim, outputDim);\n  }\n}\n\n/**\n * Fallback implementation using basic matrix multiplication\n */\nfunction hierarchicalForwardFallback(\n  input: number[],\n  weights: number[] | number[][],\n  inputDim: number,\n  outputDim: number\n): number[] {\n  // Simple matrix multiplication: output = input * weights^T\n  const output = new Array(outputDim).fill(0);\n\n  if (Array.isArray(weights[0])) {\n    // weights is 2D array [outputDim][inputDim]\n    const weightsMatrix = weights as number[][];\n    for (let i = 0; i < outputDim; i++) {\n      for (let j = 0; j < inputDim; j++) {\n        output[i] += input[j] * weightsMatrix[i][j];\n      }\n    }\n  } else {\n    // weights is 1D array (flattened)\n    const weightsFlat = weights as number[];\n    for (let i = 0; i < outputDim; i++) {\n      for (let j = 0; j < inputDim; j++) {\n        output[i] += input[j] * weightsFlat[i * inputDim + j];\n      }\n    }\n  }\n\n  return output;\n}\n\n/**\n * RuvectorLayer wrapper with fallback\n */\nexport class RuvectorLayer {\n  private inputDim: number;\n  private outputDim: number;\n  private weights: number[][];\n  private activation: 'relu' | 'tanh' | 'sigmoid' | 'none';\n\n  constructor(\n    inputDim: number,\n    outputDim: number,\n    activation: 'relu' | 'tanh' | 'sigmoid' | 'none' = 'relu'\n  ) {\n    this.inputDim = inputDim;\n    this.outputDim = outputDim;\n    this.activation = activation;\n\n    // Initialize random weights\n    this.weights = Array.from({ length: outputDim }, () =>\n      Array.from({ length: inputDim }, () => (Math.random() - 0.5) * 0.1)\n    );\n  }\n\n  forward(input: number[]): number[] {\n    if (input.length !== this.inputDim) {\n      throw new Error(\n        `Input dimension mismatch: expected ${this.inputDim}, got ${input.length}`\n      );\n    }\n\n    // Matrix multiplication\n    let output = hierarchicalForwardFallback(\n      input,\n      this.weights,\n      this.inputDim,\n      this.outputDim\n    );\n\n    // Apply activation\n    output = this.applyActivation(output);\n\n    return output;\n  }\n\n  private applyActivation(values: number[]): number[] {\n    switch (this.activation) {\n      case 'relu':\n        return values.map(v => Math.max(0, v));\n      case 'tanh':\n        return values.map(v => Math.tanh(v));\n      case 'sigmoid':\n        return values.map(v => 1 / (1 + Math.exp(-v)));\n      case 'none':\n        return values;\n      default:\n        return values;\n    }\n  }\n\n  getWeights(): number[][] {\n    return this.weights;\n  }\n\n  setWeights(weights: number[][]): void {\n    if (weights.length !== this.outputDim || weights[0].length !== this.inputDim) {\n      throw new Error('Weight dimensions do not match layer dimensions');\n    }\n    this.weights = weights;\n  }\n}\n\n/**\n * TensorCompress wrapper with working compression levels\n */\nexport class TensorCompress {\n  private config: CompressionConfig;\n\n  constructor(config: string | CompressionConfig) {\n    if (typeof config === 'string') {\n      this.config = { levelType: config as any };\n    } else {\n      this.config = config;\n    }\n  }\n\n  compress(tensor: number[]): number[] {\n    switch (this.config.levelType) {\n      case 'none':\n        return tensor;\n\n      case 'half':\n        // 16-bit float compression (approximate with scale)\n        const scale = this.config.scale || 1.0;\n        return tensor.map(v => Math.round(v / scale) * scale);\n\n      case 'pq8':\n      case 'pq4':\n        // Product quantization (simplified)\n        const bits = this.config.levelType === 'pq8' ? 8 : 4;\n        const levels = Math.pow(2, bits);\n        const min = Math.min(...tensor);\n        const max = Math.max(...tensor);\n        const range = max - min;\n        return tensor.map(v => {\n          const quantized = Math.round(((v - min) / range) * (levels - 1));\n          return (quantized / (levels - 1)) * range + min;\n        });\n\n      case 'binary':\n        // Binary quantization\n        const threshold = this.config.threshold || 0;\n        return tensor.map(v => (v > threshold ? 1 : 0));\n\n      default:\n        return tensor;\n    }\n  }\n\n  decompress(compressed: number[]): number[] {\n    // For simple compressions, decompression is identity\n    return compressed;\n  }\n\n  getCompressionRatio(): number {\n    switch (this.config.levelType) {\n      case 'none':\n        return 1;\n      case 'half':\n        return 2; // 32-bit → 16-bit\n      case 'pq8':\n        return 4; // 32-bit → 8-bit\n      case 'pq4':\n        return 8; // 32-bit → 4-bit\n      case 'binary':\n        return 32; // 32-bit → 1-bit\n      default:\n        return 1;\n    }\n  }\n}\n\n/**\n * Get compression level configuration\n * Fixed version that returns proper config objects\n */\nexport function getCompressionLevel(level: string): CompressionConfig {\n  const configs: Record<string, CompressionConfig> = {\n    none: { levelType: 'none' },\n    half: { levelType: 'half', scale: 1.0 },\n    pq8: { levelType: 'pq8', subvectors: 8, centroids: 256 },\n    pq4: { levelType: 'pq4', subvectors: 8, centroids: 16, outlierThreshold: 0.1 },\n    binary: { levelType: 'binary', threshold: 0.0 }\n  };\n\n  if (!(level in configs)) {\n    throw new Error(\n      `Invalid compression level: ${level}. Valid options: ${Object.keys(configs).join(', ')}`\n    );\n  }\n\n  return configs[level];\n}\n\n/**\n * Check if GNN native module is available and working\n */\nexport function isGNNAvailable(): boolean {\n  try {\n    const query = new Float32Array([1.0, 0.0]);\n    const candidates = [new Float32Array([1.0, 0.0]), new Float32Array([0.0, 1.0])];\n    gnn.differentiableSearch(query, candidates, 2, 1.0);\n    return true;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Initialize GNN module (if needed)\n */\nexport function initGNN(): void {\n  if (typeof gnn.init === 'function') {\n    gnn.init();\n  }\n}\n\n// Export original for advanced users who want direct access\nexport { gnn as gnnRaw };\n\n// Re-export SearchResult type\nexport type { SearchResult as GNNSearchResult };\n"]}