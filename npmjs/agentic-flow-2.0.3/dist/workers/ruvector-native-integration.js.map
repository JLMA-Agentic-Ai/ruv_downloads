{"version":3,"file":"ruvector-native-integration.js","sourceRoot":"","sources":["../../src/workers/ruvector-native-integration.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * RuVector Native Integration\n *\n * REFACTORED: Core phases are now in consolidated-phases.ts\n * This module provides the native runner wrapper and adapters.\n */\n\nimport { WorkerContext, WorkerTrigger } from './types.js';\nimport { PhaseResult } from './custom-worker-config.js';\nimport {\n  UnifiedPhaseContext,\n  createUnifiedContext,\n  runUnifiedPipeline,\n  getUnifiedPhase,\n  listUnifiedPhases\n} from './consolidated-phases.js';\n\n// Re-export PhaseContext for backwards compatibility\nexport type PhaseContext = UnifiedPhaseContext;\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport interface RuVectorNativeConfig {\n  onnxModelPath?: string;\n  vectorDimension: number;\n  hnswM?: number;\n  hnswEfConstruction?: number;\n  enableSIMD: boolean;\n  cacheEmbeddings: boolean;\n}\n\nexport interface NativeWorkerResult {\n  success: boolean;\n  phases: string[];\n  metrics: {\n    filesAnalyzed: number;\n    patternsFound: number;\n    embeddingsGenerated: number;\n    vectorsStored: number;\n    durationMs: number;\n    onnxLatencyMs?: number;\n    throughputOpsPerSec?: number;\n  };\n  data: Record<string, unknown>;\n}\n\nexport interface NativePhase {\n  name: string;\n  description: string;\n  execute: (context: NativePhaseContext) => Promise<NativePhaseResult>;\n}\n\nexport interface NativePhaseContext {\n  workDir: string;\n  files: string[];\n  patterns: string[];\n  embeddings: Map<string, Float32Array>;\n  vectors: Map<string, number[]>;\n  options: Record<string, unknown>;\n}\n\nexport interface NativePhaseResult {\n  success: boolean;\n  filesProcessed?: number;\n  patternsFound?: number;\n  embeddingsGenerated?: number;\n  vectorsStored?: number;\n  data?: Record<string, unknown>;\n  error?: string;\n}\n\n// ============================================================================\n// Native Phase Registry (delegates to consolidated phases)\n// ============================================================================\n\nconst nativePhases: Map<string, NativePhase> = new Map();\n\n// Map consolidated phases to native phase format\nconst consolidatedToNative = [\n  'file-discovery',\n  'pattern-extraction',\n  'embedding-generation',\n  'vector-storage',\n  'security-analysis',\n  'complexity-analysis',\n  'dependency-discovery',\n  'summarization',\n  'api-discovery',\n  'todo-extraction'\n];\n\n// Register wrapper phases that delegate to consolidated\nfor (const phaseName of consolidatedToNative) {\n  const unifiedPhase = getUnifiedPhase(phaseName);\n  if (unifiedPhase) {\n    nativePhases.set(phaseName, {\n      name: phaseName,\n      description: `Unified ${phaseName} phase`,\n      execute: async (context: NativePhaseContext): Promise<NativePhaseResult> => {\n        const workerContext: WorkerContext = {\n          workerId: 'native-runner',\n          trigger: 'optimize' as WorkerTrigger,\n          topic: null,\n          sessionId: `native-${Date.now()}`,\n          startTime: Date.now(),\n          signal: new AbortController().signal,\n          onProgress: () => {},\n          onMemoryDeposit: () => {}\n        };\n\n        const phaseContext = createUnifiedContext();\n        phaseContext.files = [...context.files];\n        phaseContext.patterns = [...context.patterns];\n\n        const result = await unifiedPhase(workerContext, phaseContext, context.options);\n\n        // Sync back\n        context.files.push(...phaseContext.files.filter(f => !context.files.includes(f)));\n        context.patterns.push(...phaseContext.patterns.filter(p => !context.patterns.includes(p)));\n        for (const [k, v] of phaseContext.embeddings) context.embeddings.set(k, v);\n        for (const [k, v] of phaseContext.vectors) context.vectors.set(k, v);\n\n        return {\n          success: result.success,\n          filesProcessed: phaseContext.files.length,\n          patternsFound: phaseContext.patterns.length,\n          embeddingsGenerated: phaseContext.embeddings.size,\n          vectorsStored: phaseContext.vectors.size,\n          data: result.data,\n          error: result.error\n        };\n      }\n    });\n  }\n}\n\n// Alias security-scan to security-analysis for backwards compatibility\nconst securityPhase = nativePhases.get('security-analysis');\nif (securityPhase) {\n  nativePhases.set('security-scan', {\n    ...securityPhase,\n    name: 'security-scan'\n  });\n}\n\n/**\n * Register a native ruvector phase\n */\nexport function registerNativePhase(name: string, phase: NativePhase): void {\n  nativePhases.set(name, phase);\n}\n\n/**\n * Get registered native phases\n */\nexport function listNativePhases(): string[] {\n  return Array.from(nativePhases.keys());\n}\n\n// ============================================================================\n// Native Worker Runner\n// ============================================================================\n\nexport class RuVectorNativeRunner {\n  private config: RuVectorNativeConfig;\n\n  constructor(config: Partial<RuVectorNativeConfig> = {}) {\n    this.config = {\n      vectorDimension: 384,\n      enableSIMD: true,\n      cacheEmbeddings: true,\n      ...config\n    };\n  }\n\n  /**\n   * Run a native worker with specified phases\n   */\n  async run(\n    workDir: string,\n    phases: string[],\n    options: Record<string, unknown> = {}\n  ): Promise<NativeWorkerResult> {\n    const startTime = Date.now();\n    const executedPhases: string[] = [];\n    let totalFiles = 0;\n    let totalPatterns = 0;\n    let totalEmbeddings = 0;\n    let totalVectors = 0;\n    let onnxLatencyMs = 0;\n\n    const context: NativePhaseContext = {\n      workDir,\n      files: [],\n      patterns: [],\n      embeddings: new Map(),\n      vectors: new Map(),\n      options\n    };\n\n    const phaseResults: Record<string, NativePhaseResult> = {};\n\n    for (const phaseName of phases) {\n      const phase = nativePhases.get(phaseName);\n      if (!phase) {\n        console.warn(`Unknown native phase: ${phaseName}`);\n        continue;\n      }\n\n      try {\n        const result = await phase.execute(context);\n        phaseResults[phaseName] = result;\n        executedPhases.push(phaseName);\n\n        if (result.filesProcessed) totalFiles = Math.max(totalFiles, result.filesProcessed);\n        if (result.patternsFound) totalPatterns = Math.max(totalPatterns, result.patternsFound);\n        if (result.embeddingsGenerated) totalEmbeddings = result.embeddingsGenerated;\n        if (result.vectorsStored) totalVectors = result.vectorsStored;\n        if (result.data?.onnxLatencyMs) onnxLatencyMs = result.data.onnxLatencyMs as number;\n        if (result.data?.durationMs) onnxLatencyMs = result.data.durationMs as number;\n\n        if (!result.success) {\n          console.warn(`Phase ${phaseName} failed:`, result.error);\n        }\n      } catch (error) {\n        console.error(`Phase ${phaseName} error:`, error);\n      }\n    }\n\n    const durationMs = Date.now() - startTime;\n\n    return {\n      success: true,\n      phases: executedPhases,\n      metrics: {\n        filesAnalyzed: totalFiles || context.files.length,\n        patternsFound: totalPatterns || context.patterns.length,\n        embeddingsGenerated: totalEmbeddings || context.embeddings.size,\n        vectorsStored: totalVectors || context.vectors.size,\n        durationMs,\n        onnxLatencyMs,\n        throughputOpsPerSec: context.embeddings.size > 0\n          ? context.embeddings.size / (durationMs / 1000)\n          : 0\n      },\n      data: phaseResults\n    };\n  }\n\n  /**\n   * Run security scan worker\n   */\n  async runSecurityScan(workDir: string): Promise<NativeWorkerResult> {\n    return this.run(workDir, [\n      'file-discovery',\n      'security-analysis',  // Uses consolidated phase\n      'summarization'\n    ], {\n      patterns: ['**/*.{ts,js,tsx,jsx,py,go,java}'],\n      ignore: ['node_modules/**', 'dist/**', '.git/**', 'vendor/**']\n    });\n  }\n\n  /**\n   * Run full analysis worker\n   */\n  async runFullAnalysis(workDir: string): Promise<NativeWorkerResult> {\n    return this.run(workDir, [\n      'file-discovery',\n      'pattern-extraction',\n      'embedding-generation',\n      'vector-storage',\n      'complexity-analysis',\n      'summarization'\n    ]);\n  }\n\n  /**\n   * Run learning worker\n   */\n  async runLearning(workDir: string): Promise<NativeWorkerResult> {\n    return this.run(workDir, [\n      'file-discovery',\n      'pattern-extraction',\n      'embedding-generation',\n      'vector-storage',\n      'summarization'\n    ]);\n  }\n}\n\n// ============================================================================\n// Phase Executor Adapters (for agentic-flow integration)\n// ============================================================================\n\n/**\n * Create agentic-flow phase executor from native phase\n */\nexport function createPhaseExecutorFromNative(\n  nativePhaseName: string\n): (context: WorkerContext, phaseContext: UnifiedPhaseContext, options: Record<string, unknown>) => Promise<PhaseResult> {\n  return async (workerContext, phaseContext, options) => {\n    const phase = nativePhases.get(nativePhaseName);\n    if (!phase) {\n      return {\n        success: false,\n        data: {},\n        patterns: [],\n        error: `Native phase not found: ${nativePhaseName}`\n      };\n    }\n\n    const nativeContext: NativePhaseContext = {\n      workDir: process.cwd(),\n      files: phaseContext.files,\n      patterns: phaseContext.patterns,\n      embeddings: phaseContext.embeddings,\n      vectors: phaseContext.vectors,\n      options\n    };\n\n    const result = await phase.execute(nativeContext);\n\n    return {\n      success: result.success,\n      data: result.data || {},\n      patterns: nativeContext.patterns,\n      error: result.error\n    };\n  };\n}\n\n// ============================================================================\n// Singleton and Exports\n// ============================================================================\n\nexport const nativeRunner = new RuVectorNativeRunner();\n\nexport async function runNativeSecurityScan(workDir: string = process.cwd()): Promise<NativeWorkerResult> {\n  return nativeRunner.runSecurityScan(workDir);\n}\n\nexport async function runNativeAnalysis(workDir: string = process.cwd()): Promise<NativeWorkerResult> {\n  return nativeRunner.runFullAnalysis(workDir);\n}\n\nexport async function runNativeLearning(workDir: string = process.cwd()): Promise<NativeWorkerResult> {\n  return nativeRunner.runLearning(workDir);\n}\n"]}