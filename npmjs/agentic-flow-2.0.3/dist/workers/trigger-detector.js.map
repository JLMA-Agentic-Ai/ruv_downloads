{"version":3,"file":"trigger-detector.js","sourceRoot":"","sources":["../../src/workers/trigger-detector.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * TriggerDetector - Detects background worker triggers in prompts\n * Target: < 5ms detection latency\n */\n\nimport {\n  WorkerTrigger,\n  TriggerConfig,\n  DetectedTrigger,\n  WorkerPriority\n} from './types.js';\n\n// Trigger configuration map\nconst TRIGGER_CONFIGS: Map<WorkerTrigger, TriggerConfig> = new Map([\n  ['ultralearn', {\n    keyword: 'ultralearn',\n    worker: 'research-swarm',\n    priority: 'high',\n    maxAgents: 5,\n    timeout: 300000,      // 5 minutes\n    cooldown: 60000,      // 1 minute\n    topicExtractor: /ultralearn\\s+(.+?)(?:\\.|$)/i,\n    description: 'Deep research swarm for codebase learning'\n  }],\n  ['optimize', {\n    keyword: 'optimize',\n    worker: 'perf-analyzer',\n    priority: 'medium',\n    maxAgents: 2,\n    timeout: 180000,      // 3 minutes\n    cooldown: 120000,     // 2 minutes\n    topicExtractor: /optimize\\s+(.+?)(?:\\.|$)/i,\n    description: 'Performance analyzer and cache optimizer'\n  }],\n  ['consolidate', {\n    keyword: 'consolidate',\n    worker: 'memory-optimizer',\n    priority: 'low',\n    maxAgents: 1,\n    timeout: 120000,      // 2 minutes\n    cooldown: 300000,     // 5 minutes\n    topicExtractor: null,\n    description: 'Memory compaction and pattern extraction'\n  }],\n  ['predict', {\n    keyword: 'predict',\n    worker: 'pattern-matcher',\n    priority: 'medium',\n    maxAgents: 2,\n    timeout: 60000,       // 1 minute\n    cooldown: 30000,      // 30 seconds\n    topicExtractor: /predict\\s+(.+?)(?:\\.|$)/i,\n    description: 'Pre-fetch likely files based on learned patterns'\n  }],\n  ['audit', {\n    keyword: 'audit',\n    worker: 'security-scanner',\n    priority: 'high',\n    maxAgents: 3,\n    timeout: 300000,      // 5 minutes\n    cooldown: 180000,     // 3 minutes\n    topicExtractor: /audit\\s+(.+?)(?:\\.|$)/i,\n    description: 'Security and code quality scan'\n  }],\n  ['map', {\n    keyword: 'map',\n    worker: 'dependency-mapper',\n    priority: 'medium',\n    maxAgents: 2,\n    timeout: 240000,      // 4 minutes\n    cooldown: 300000,     // 5 minutes\n    topicExtractor: /map\\s+(.+?)(?:\\.|$)/i,\n    description: 'Build full dependency graph'\n  }],\n  ['preload', {\n    keyword: 'preload',\n    worker: 'context-prefetcher',\n    priority: 'low',\n    maxAgents: 1,\n    timeout: 30000,       // 30 seconds\n    cooldown: 10000,      // 10 seconds\n    topicExtractor: /preload\\s+(.+?)(?:\\.|$)/i,\n    description: 'Pre-fetch context for faster access'\n  }],\n  ['deepdive', {\n    keyword: 'deepdive',\n    worker: 'call-graph-analyzer',\n    priority: 'high',\n    maxAgents: 4,\n    timeout: 600000,      // 10 minutes\n    cooldown: 300000,     // 5 minutes\n    topicExtractor: /deepdive\\s+(.+?)(?:\\.|$)/i,\n    description: 'Traces call paths 5+ levels deep'\n  }],\n  ['document', {\n    keyword: 'document',\n    worker: 'doc-generator',\n    priority: 'low',\n    maxAgents: 2,\n    timeout: 180000,\n    cooldown: 120000,\n    topicExtractor: /document\\s+(.+?)(?:\\.|$)/i,\n    description: 'Generate documentation for patterns'\n  }],\n  ['refactor', {\n    keyword: 'refactor',\n    worker: 'refactor-analyzer',\n    priority: 'medium',\n    maxAgents: 2,\n    timeout: 180000,\n    cooldown: 120000,\n    topicExtractor: /refactor\\s+(.+?)(?:\\.|$)/i,\n    description: 'Identify refactoring opportunities'\n  }],\n  ['benchmark', {\n    keyword: 'benchmark',\n    worker: 'perf-benchmarker',\n    priority: 'medium',\n    maxAgents: 2,\n    timeout: 300000,\n    cooldown: 180000,\n    topicExtractor: /benchmark\\s+(.+?)(?:\\.|$)/i,\n    description: 'Run performance benchmarks silently'\n  }],\n  ['testgaps', {\n    keyword: 'testgaps',\n    worker: 'coverage-analyzer',\n    priority: 'medium',\n    maxAgents: 2,\n    timeout: 180000,\n    cooldown: 120000,\n    topicExtractor: /testgaps?\\s+(.+?)(?:\\.|$)/i,\n    description: 'Find untested code paths'\n  }]\n]);\n\n// Pre-compiled regex for fast matching\nconst TRIGGER_PATTERN = new RegExp(\n  `\\\\b(${Array.from(TRIGGER_CONFIGS.keys()).join('|')})\\\\b`,\n  'gi'\n);\n\nexport class TriggerDetector {\n  private cooldowns: Map<WorkerTrigger, number> = new Map();\n\n  /**\n   * Detect all triggers in a prompt\n   * Target: < 5ms latency\n   */\n  detect(prompt: string): DetectedTrigger[] {\n    const startTime = performance.now();\n    const triggers: DetectedTrigger[] = [];\n    const seen = new Set<WorkerTrigger>();\n\n    // Fast regex match\n    let match: RegExpExecArray | null;\n    TRIGGER_PATTERN.lastIndex = 0;\n\n    while ((match = TRIGGER_PATTERN.exec(prompt)) !== null) {\n      const keyword = match[1].toLowerCase() as WorkerTrigger;\n\n      // Skip duplicates\n      if (seen.has(keyword)) continue;\n      seen.add(keyword);\n\n      // Check cooldown\n      if (this.isOnCooldown(keyword)) continue;\n\n      const config = TRIGGER_CONFIGS.get(keyword);\n      if (!config) continue;\n\n      // Extract topic if extractor exists\n      let topic: string | null = null;\n      if (config.topicExtractor) {\n        const topicMatch = prompt.match(config.topicExtractor);\n        if (topicMatch && topicMatch[1]) {\n          topic = topicMatch[1].trim();\n        }\n      }\n\n      triggers.push({\n        keyword,\n        topic,\n        config,\n        detectedAt: Date.now()\n      });\n\n      // Set cooldown\n      this.setCooldown(keyword);\n    }\n\n    const elapsed = performance.now() - startTime;\n    if (elapsed > 5) {\n      console.warn(`TriggerDetector: detection took ${elapsed.toFixed(2)}ms (target: 5ms)`);\n    }\n\n    return triggers;\n  }\n\n  /**\n   * Check if a trigger is on cooldown\n   */\n  isOnCooldown(trigger: WorkerTrigger): boolean {\n    const lastUsed = this.cooldowns.get(trigger);\n    if (!lastUsed) return false;\n\n    const config = TRIGGER_CONFIGS.get(trigger);\n    if (!config) return false;\n\n    return Date.now() - lastUsed < config.cooldown;\n  }\n\n  /**\n   * Set cooldown for a trigger\n   */\n  private setCooldown(trigger: WorkerTrigger): void {\n    this.cooldowns.set(trigger, Date.now());\n  }\n\n  /**\n   * Clear cooldown for a trigger (for testing)\n   */\n  clearCooldown(trigger: WorkerTrigger): void {\n    this.cooldowns.delete(trigger);\n  }\n\n  /**\n   * Clear all cooldowns\n   */\n  clearAllCooldowns(): void {\n    this.cooldowns.clear();\n  }\n\n  /**\n   * Get remaining cooldown time for a trigger\n   */\n  getCooldownRemaining(trigger: WorkerTrigger): number {\n    const lastUsed = this.cooldowns.get(trigger);\n    if (!lastUsed) return 0;\n\n    const config = TRIGGER_CONFIGS.get(trigger);\n    if (!config) return 0;\n\n    const remaining = config.cooldown - (Date.now() - lastUsed);\n    return Math.max(0, remaining);\n  }\n\n  /**\n   * Get config for a specific trigger\n   */\n  getConfig(trigger: WorkerTrigger): TriggerConfig | undefined {\n    return TRIGGER_CONFIGS.get(trigger);\n  }\n\n  /**\n   * Get all trigger configs\n   */\n  getAllConfigs(): Map<WorkerTrigger, TriggerConfig> {\n    return new Map(TRIGGER_CONFIGS);\n  }\n\n  /**\n   * Register a custom trigger dynamically\n   */\n  registerTrigger(config: {\n    keyword: string;\n    priority?: WorkerPriority;\n    description?: string;\n    timeout?: number;\n    cooldown?: number;\n    topicExtractor?: RegExp;\n  }): void {\n    const keyword = config.keyword as WorkerTrigger;\n    const triggerConfig: TriggerConfig = {\n      keyword,\n      worker: config.keyword,\n      priority: config.priority || 'medium',\n      maxAgents: 2,\n      timeout: config.timeout || 120000,\n      cooldown: config.cooldown || 5000,\n      topicExtractor: config.topicExtractor || null,\n      description: config.description || `Custom trigger: ${config.keyword}`\n    };\n    TRIGGER_CONFIGS.set(keyword, triggerConfig);\n  }\n\n  /**\n   * Check if a string contains any trigger keywords\n   * Faster than full detect() when you just need boolean check\n   */\n  hasTriggers(prompt: string): boolean {\n    TRIGGER_PATTERN.lastIndex = 0;\n    return TRIGGER_PATTERN.test(prompt);\n  }\n\n  /**\n   * Get trigger stats\n   */\n  getStats(): { triggers: WorkerTrigger[]; cooldowns: Record<string, number> } {\n    const cooldowns: Record<string, number> = {};\n    for (const [trigger, time] of this.cooldowns) {\n      cooldowns[trigger] = this.getCooldownRemaining(trigger);\n    }\n    return {\n      triggers: Array.from(TRIGGER_CONFIGS.keys()),\n      cooldowns\n    };\n  }\n}\n\n// Singleton instance\nlet instance: TriggerDetector | null = null;\n\nexport function getTriggerDetector(): TriggerDetector {\n  if (!instance) {\n    instance = new TriggerDetector();\n  }\n  return instance;\n}\n\nexport { TRIGGER_CONFIGS };\n"]}