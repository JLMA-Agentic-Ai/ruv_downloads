{"version":3,"file":"sona-train.js","sourceRoot":"","sources":["../../../src/cli/commands/sona-train.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * SONA Training CLI Commands\n *\n * Train specialized agents with SONA continuous learning\n */\n\nimport { Command } from 'commander';\nimport { AgentFactory, CodebaseTrainer, AgentTemplates } from '../../services/sona-agent-training.js';\nimport { ValidationUtils } from '../../services/sona-types.js';\nimport { readFileSync, writeFileSync, readdirSync, statSync, mkdirSync } from 'fs';\nimport { join, extname, resolve } from 'path';\n\nexport function createSONATrainingCommands(program: Command) {\n  const sonaTrain = program\n    .command('sona-train')\n    .description('Train specialized SONA agents');\n\n  // Create agent\n  sonaTrain\n    .command('create-agent')\n    .description('Create a new specialized agent')\n    .requiredOption('-n, --name <name>', 'Agent name')\n    .option('-p, --purpose <type>', 'Agent purpose: simple, complex, diverse', 'simple')\n    .option('-t, --template <template>', 'Use template: code, chat, data, rag, planner, expert')\n    .option('--domain <domain>', 'Domain for expert template')\n    .action(async (options) => {\n      try {\n        const factory = new AgentFactory();\n\n        let config;\n        if (options.template) {\n          switch (options.template) {\n            case 'code':\n              config = AgentTemplates.codeAssistant();\n              break;\n            case 'chat':\n              config = AgentTemplates.chatBot();\n              break;\n            case 'data':\n              config = AgentTemplates.dataAnalyst();\n              break;\n            case 'rag':\n              config = AgentTemplates.ragAgent();\n              break;\n            case 'planner':\n              config = AgentTemplates.taskPlanner();\n              break;\n            case 'expert':\n              if (!options.domain) {\n                throw new Error('--domain required for expert template');\n              }\n              config = AgentTemplates.domainExpert(options.domain);\n              break;\n            default:\n              throw new Error(`Unknown template: ${options.template}`);\n          }\n          config.name = options.name;\n        } else {\n          config = {\n            name: options.name,\n            purpose: options.purpose as any\n          };\n        }\n\n        const engine = factory.createAgent(options.name, config);\n        const stats = factory.getAgentStats(options.name);\n\n        console.log('\\n‚úÖ Agent created successfully!');\n        console.log(`   Name: ${stats?.name}`);\n        console.log(`   Purpose: ${stats?.purpose}`);\n        console.log(`   Base LoRA Rank: ${stats?.config.baseLoraRank}`);\n        console.log(`   Pattern Clusters: ${stats?.config.patternClusters}`);\n        console.log(`   Quality Threshold: ${stats?.config.qualityThreshold}`);\n        console.log(`   Route: ${stats?.config.route || 'default'}\\n`);\n\n        // Save agent config (with path validation)\n        const baseDir = resolve(process.cwd(), '.sona-agents');\n        mkdirSync(baseDir, { recursive: true });\n\n        const safePath = ValidationUtils.sanitizePath(\n          join('.sona-agents', `${options.name}.json`),\n          process.cwd()\n        );\n\n        writeFileSync(safePath, JSON.stringify(stats, null, 2));\n        console.log(`   Config saved: ${safePath}\\n`);\n\n      } catch (error: any) {\n        console.error(`\\n‚ùå Error creating agent: ${error.message}\\n`);\n        process.exit(1);\n      }\n    });\n\n  // Train agent\n  sonaTrain\n    .command('train')\n    .description('Train an agent on examples')\n    .requiredOption('-n, --name <name>', 'Agent name')\n    .requiredOption('-d, --data <file>', 'Training data file (JSONL)')\n    .option('-b, --batch-size <number>', 'Batch size', '100')\n    .action(async (options) => {\n      try {\n        const factory = new AgentFactory();\n\n        // Load agent config (with path validation)\n        const safePath = ValidationUtils.sanitizePath(\n          join('.sona-agents', `${options.name}.json`),\n          process.cwd()\n        );\n        const agentConfig = JSON.parse(readFileSync(safePath, 'utf8'));\n\n        // Recreate agent\n        factory.createAgent(options.name, agentConfig.config);\n\n        // Load training data\n        const dataContent = readFileSync(options.data, 'utf8');\n        const lines = dataContent.split('\\n').filter(l => l.trim());\n        const examples = lines.map(line => JSON.parse(line));\n\n        console.log(`\\nüéì Training agent: ${options.name}`);\n        console.log(`   Examples: ${examples.length}`);\n        console.log(`   Batch size: ${options.batchSize}\\n`);\n\n        // Train in batches\n        const batchSize = parseInt(options.batchSize);\n        let totalTrained = 0;\n\n        for (let i = 0; i < examples.length; i += batchSize) {\n          const batch = examples.slice(i, i + batchSize);\n          const trained = await factory.trainAgent(options.name, batch);\n          totalTrained += trained;\n\n          console.log(`   Batch ${Math.floor(i / batchSize) + 1}: ${trained} examples`);\n        }\n\n        const stats = factory.getAgentStats(options.name);\n        console.log(`\\n‚úÖ Training complete!`);\n        console.log(`   Total examples: ${totalTrained}`);\n        console.log(`   Avg quality: ${stats?.avgQuality.toFixed(3)}`);\n        console.log(`   Patterns learned: ${stats?.patterns}\\n`);\n\n      } catch (error: any) {\n        console.error(`\\n‚ùå Error training agent: ${error.message}\\n`);\n        process.exit(1);\n      }\n    });\n\n  // Index codebase\n  sonaTrain\n    .command('index-codebase')\n    .description('Index a codebase for pattern learning')\n    .requiredOption('-p, --path <path>', 'Path to codebase')\n    .option('-e, --extensions <exts>', 'File extensions (comma-separated)', 'ts,js,py,rs,go')\n    .option('--max-files <number>', 'Maximum files to index', '1000')\n    .action(async (options) => {\n      try {\n        const trainer = new CodebaseTrainer();\n\n        console.log(`\\nüìö Indexing codebase: ${options.path}\\n`);\n\n        // Find code files\n        const extensions = options.extensions.split(',').map((e: string) => e.trim());\n        const files = findCodeFiles(options.path, extensions, parseInt(options.maxFiles));\n\n        console.log(`   Found ${files.length} files\\n`);\n\n        // Index codebase\n        const chunks = await trainer.indexCodebase(files);\n\n        const stats = trainer.getStats();\n        console.log(`\\n‚úÖ Indexing complete!`);\n        console.log(`   Files indexed: ${files.length}`);\n        console.log(`   Code chunks: ${chunks}`);\n        console.log(`   Patterns: ${stats.totalPatterns || 0}\\n`);\n\n        // Save index (with path validation)\n        const safePath = ValidationUtils.sanitizePath(\n          '.sona-codebase-index.json',\n          process.cwd()\n        );\n        writeFileSync(safePath, JSON.stringify({\n          path: options.path,\n          files: files.length,\n          chunks,\n          stats,\n          indexed: new Date().toISOString()\n        }, null, 2));\n\n        console.log(`   Index saved: ${safePath}\\n`);\n\n      } catch (error: any) {\n        console.error(`\\n‚ùå Error indexing codebase: ${error.message}\\n`);\n        process.exit(1);\n      }\n    });\n\n  // List agents\n  sonaTrain\n    .command('list')\n    .description('List all trained agents')\n    .action(() => {\n      try {\n        const factory = new AgentFactory();\n\n        // Load all agent configs (with path validation)\n        const baseDir = resolve(process.cwd(), '.sona-agents');\n\n        try {\n          const files = readdirSync(baseDir);\n          const agents = files\n            .filter(f => f.endsWith('.json'))\n            .map(f => {\n              const safePath = ValidationUtils.sanitizePath(join('.sona-agents', f), process.cwd());\n              return JSON.parse(readFileSync(safePath, 'utf8'));\n            });\n\n          if (agents.length === 0) {\n            console.log('\\nüìù No agents found. Create one with: sona-train create-agent\\n');\n            return;\n          }\n\n          console.log('\\nüìã Trained Agents:\\n');\n          console.log('  Name                 Purpose    Training  Avg Quality  Patterns');\n          console.log('  ' + '‚îÄ'.repeat(70));\n\n          for (const agent of agents) {\n            console.log(\n              `  ${agent.name.padEnd(20)} ` +\n              `${agent.purpose.padEnd(10)} ` +\n              `${agent.trainingCount.toString().padEnd(9)} ` +\n              `${agent.avgQuality.toFixed(3).padEnd(12)} ` +\n              `${agent.patterns}`\n            );\n          }\n\n          console.log('');\n        } catch (dirError: any) {\n          if (dirError.code === 'ENOENT') {\n            console.log('\\nüìù No agents found. Create one with: sona-train create-agent\\n');\n          } else {\n            throw dirError;\n          }\n        }\n\n      } catch (error: any) {\n        console.error(`\\n‚ùå Error listing agents: ${error.message}\\n`);\n      }\n    });\n\n  // Query agent\n  sonaTrain\n    .command('query')\n    .description('Query an agent with pattern matching')\n    .requiredOption('-n, --name <name>', 'Agent name')\n    .requiredOption('-q, --query <text>', 'Query text')\n    .option('-k <number>', 'Number of patterns to retrieve', '5')\n    .action(async (options) => {\n      try {\n        const factory = new AgentFactory();\n\n        // Load agent config (with path validation)\n        const safePath = ValidationUtils.sanitizePath(\n          join('.sona-agents', `${options.name}.json`),\n          process.cwd()\n        );\n        const agentConfig = JSON.parse(readFileSync(safePath, 'utf8'));\n        factory.createAgent(options.name, agentConfig.config);\n\n        // Mock embedding (in production, use actual embedding service)\n        const queryEmbedding = mockEmbedding(options.query);\n\n        // Find patterns\n        const patterns = await factory.findPatterns(options.name, queryEmbedding, parseInt(options.k));\n\n        console.log(`\\nüîç Query: \"${options.query}\"\\n`);\n        console.log(`   Found ${patterns.length} similar patterns:\\n`);\n\n        for (let i = 0; i < patterns.length; i++) {\n          const p = patterns[i];\n          console.log(`   ${i + 1}. Quality: ${p.avgQuality?.toFixed(3) || 'N/A'}`);\n          console.log(`      Similarity: ${p.similarity?.toFixed(3) || 'N/A'}`);\n          console.log(`      Context: ${p.context || 'none'}\\n`);\n        }\n\n      } catch (error: any) {\n        console.error(`\\n‚ùå Error querying agent: ${error.message}\\n`);\n        process.exit(1);\n      }\n    });\n\n  return sonaTrain;\n}\n\n/**\n * Find code files in directory\n */\nfunction findCodeFiles(\n  dir: string,\n  extensions: string[],\n  maxFiles: number\n): Array<{ path: string; language: string; content: string }> {\n  const files: any[] = [];\n\n  function scan(currentDir: string) {\n    if (files.length >= maxFiles) return;\n\n    const entries = readdirSync(currentDir);\n\n    for (const entry of entries) {\n      if (files.length >= maxFiles) break;\n\n      const fullPath = join(currentDir, entry);\n      const stat = statSync(fullPath);\n\n      if (stat.isDirectory()) {\n        if (!entry.startsWith('.') && entry !== 'node_modules') {\n          scan(fullPath);\n        }\n      } else {\n        const ext = extname(entry).slice(1);\n        if (extensions.includes(ext)) {\n          try {\n            const content = readFileSync(fullPath, 'utf8');\n            files.push({\n              path: fullPath,\n              language: ext,\n              content\n            });\n          } catch (error) {\n            // Skip unreadable files\n          }\n        }\n      }\n    }\n  }\n\n  scan(dir);\n  return files;\n}\n\n/**\n * Mock embedding (replace with actual embedding service)\n */\nfunction mockEmbedding(text: string): number[] {\n  const hash = text.split('').reduce((acc, char) => {\n    return ((acc << 5) - acc) + char.charCodeAt(0);\n  }, 0);\n\n  const embedding = new Array(3072);\n  for (let i = 0; i < 3072; i++) {\n    const seed = hash + i;\n    embedding[i] = (Math.sin(seed) * 10000) - Math.floor(Math.sin(seed) * 10000);\n  }\n\n  return embedding;\n}\n"]}