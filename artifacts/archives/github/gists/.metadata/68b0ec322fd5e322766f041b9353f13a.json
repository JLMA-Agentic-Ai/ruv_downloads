{
  "url": "https://api.github.com/gists/68b0ec322fd5e322766f041b9353f13a",
  "forks_url": "https://api.github.com/gists/68b0ec322fd5e322766f041b9353f13a/forks",
  "commits_url": "https://api.github.com/gists/68b0ec322fd5e322766f041b9353f13a/commits",
  "id": "68b0ec322fd5e322766f041b9353f13a",
  "node_id": "G_kwDOACzGetoAIDY4YjBlYzMyMmZkNWUzMjI3NjZmMDQxYjkzNTNmMTNh",
  "git_pull_url": "https://gist.github.com/68b0ec322fd5e322766f041b9353f13a.git",
  "git_push_url": "https://gist.github.com/68b0ec322fd5e322766f041b9353f13a.git",
  "html_url": "https://gist.github.com/ruvnet/68b0ec322fd5e322766f041b9353f13a",
  "files": {
    "polymorphic-obfuscation.md": {
      "filename": "polymorphic-obfuscation.md",
      "type": "text/markdown",
      "language": "Markdown",
      "raw_url": "https://gist.githubusercontent.com/ruvnet/68b0ec322fd5e322766f041b9353f13a/raw/b5ef7822bd3397c6d0c685625b4e7de7fc5e1ad4/polymorphic-obfuscation.md",
      "size": 6091,
      "truncated": false,
      "content": "Polymorphic obfuscation algorithm involves several complex techniques to ensure the code changes its form each time it is executed, while maintaining its original functionality. Here\u2019s a detailed overview and an example of how you might implement such an algorithm.\n\n### Key Techniques in Polymorphic Obfuscation\n\n1. **Code Obfuscation**:\n   - Use encryption, compression, or other obfuscation methods to conceal the code's true nature.\n   - Example: Encrypt the main body of the code and add a decryption function that decrypts the code before execution[3].\n\n2. **Dynamic Encryption Keys**:\n   - Use different encryption keys for each new instance of the code.\n   - Example: Generate a random key each time the code is executed and use it to decrypt the payload[1].\n\n3. **Variable Code Structure**:\n   - Change the code structure by rearranging subroutines or using different registers.\n   - Example: Rearrange the order of functions or use register swapping to alter the code's appearance[1].\n\n4. **Behavioral Adaptation**:\n   - Alter the execution patterns to blend in with normal system processes.\n   - Example: Use different execution paths or timing to make the code harder to detect[1].\n\n### Example Implementation\n\nHere is a simplified example of a polymorphic obfuscation algorithm in Python, demonstrating some of these techniques:\n\n#### Encryption and Decryption\n\n```python\nimport base64\nimport random\nimport string\n\ndef generate_random_key(length=16):\n    return ''.join(random.choice(string.ascii_letters + string.digits) for _ in range(length))\n\ndef encrypt_code(code, key):\n    # Simple XOR encryption for demonstration\n    return ''.join(chr(ord(c) ^ ord(k)) for c, k in zip(code, key * (len(code) // len(key) + 1)))\n\ndef decrypt_code(encrypted_code, key):\n    return ''.join(chr(ord(c) ^ ord(k)) for c, k in zip(encrypted_code, key * (len(encrypted_code) // len(key) + 1)))\n\n# Example code to be obfuscated\ncode = \"\"\"\ndef main():\n    print(\"Hello, World!\")\n    # Other code here...\nif __name__ == \"__main__\":\n    main()\n\"\"\"\n\n# Generate a random key\nkey = generate_random_key()\n\n# Encrypt the code\nencrypted_code = encrypt_code(code, key)\n\n# Create the obfuscated code with a decryption function\nobfuscated_code = f\"\"\"\nimport base64\n\ndef decrypt_code(encrypted_code, key):\n    return ''.join(chr(ord(c) ^ ord(k)) for c, k in zip(encrypted_code, key * (len(encrypted_code) // len(key) + 1)))\n\nkey = \"{key}\"\nencrypted_code = \"{encrypted_code}\"\n\ndecrypted_code = decrypt_code(encrypted_code, key)\nexec(decrypted_code)\n\"\"\"\n\n# Save the obfuscated code to a file\nwith open(\"obfuscated_code.py\", \"w\") as f:\n    f.write(obfuscated_code)\n```\n\n#### Variable Code Structure\n\nTo change the code structure, you can rearrange functions or use different registers. Here\u2019s an example of rearranging functions:\n\n```python\n# Original code\ncode = \"\"\"\ndef function_a():\n    print(\"Function A\")\n\ndef function_b():\n    print(\"Function B\")\n\ndef main():\n    function_a()\n    function_b()\n\nif __name__ == \"__main__\":\n    main()\n\"\"\"\n\n# Rearrange the functions\nfunctions = [\"function_a\", \"function_b\"]\nrandom.shuffle(functions)\n\nobfuscated_code = f\"\"\"\ndef {functions}():\n    print(\"Function A\")\n\ndef {functions[1]}():\n    print(\"Function B\")\n\ndef main():\n    {functions}()\n    {functions[1]}()\n\nif __name__ == \"__main__\":\n    main()\n\"\"\"\n```\n\n#### Behavioral Adaptation\n\nTo adapt the behavior, you can introduce random delays or different execution paths:\n\n```python\nimport random\nimport time\n\n# Original code\ncode = \"\"\"\ndef main():\n    print(\"Hello, World!\")\n    # Other code here...\nif __name__ == \"__main__\":\n    main()\n\"\"\"\n\n# Introduce random delays and different execution paths\nobfuscated_code = f\"\"\"\nimport random\nimport time\n\ndef main():\n    if random.random() < 0.5:\n        time.sleep(random.uniform(0.1, 1.0))\n    print(\"Hello, World!\")\n    # Other code here...\nif __name__ == \"__main__\":\n    main()\n\"\"\"\n```\n\n### Full Example\n\nHere is a more comprehensive example that combines these techniques:\n\n```python\nimport base64\nimport random\nimport string\nimport time\n\ndef generate_random_key(length=16):\n    return ''.join(random.choice(string.ascii_letters + string.digits) for _ in range(length))\n\ndef encrypt_code(code, key):\n    return ''.join(chr(ord(c) ^ ord(k)) for c, k in zip(code, key * (len(code) // len(key) + 1)))\n\ndef decrypt_code(encrypted_code, key):\n    return ''.join(chr(ord(c) ^ ord(k)) for c, k in zip(encrypted_code, key * (len(encrypted_code) // len(key) + 1)))\n\n# Example code to be obfuscated\ncode = \"\"\"\ndef function_a():\n    print(\"Function A\")\n\ndef function_b():\n    print(\"Function B\")\n\ndef main():\n    function_a()\n    function_b()\n\nif __name__ == \"__main__\":\n    main()\n\"\"\"\n\n# Generate a random key\nkey = generate_random_key()\n\n# Encrypt the code\nencrypted_code = encrypt_code(code, key)\n\n# Rearrange the functions\nfunctions = [\"function_a\", \"function_b\"]\nrandom.shuffle(functions)\n\n# Create the obfuscated code with a decryption function and behavioral adaptation\nobfuscated_code = f\"\"\"\nimport base64\nimport random\nimport time\n\ndef decrypt_code(encrypted_code, key):\n    return ''.join(chr(ord(c) ^ ord(k)) for c, k in zip(encrypted_code, key * (len(encrypted_code) // len(key) + 1)))\n\nkey = \"{key}\"\nencrypted_code = \"{encrypted_code}\"\n\ndecrypted_code = decrypt_code(encrypted_code, key)\n\ndef {functions}():\n    print(\"Function A\")\n    if random.random() < 0.5:\n        time.sleep(random.uniform(0.1, 1.0))\n\ndef {functions[1]}():\n    print(\"Function B\")\n    if random.random() < 0.5:\n        time.sleep(random.uniform(0.1, 1.0))\n\ndef main():\n    {functions}()\n    {functions[1]}()\n\nif __name__ == \"__main__\":\n    main()\n\"\"\"\n\n# Save the obfuscated code to a file\nwith open(\"obfuscated_code.py\", \"w\") as f:\n    f.write(obfuscated_code)\n```\n\nThis example demonstrates basic polymorphic obfuscation techniques, including encryption, variable code structure, and behavioral adaptation. However, for real-world applications, more sophisticated methods and continuous evolution of the obfuscation techniques are necessary to evade detection by advanced security systems.",
      "encoding": "utf-8"
    }
  },
  "public": true,
  "created_at": "2024-11-16T15:59:56Z",
  "updated_at": "2025-12-03T12:25:11Z",
  "description": "This example demonstrates basic polymorphic obfuscation techniques, including encryption, variable code structure, and behavioral adaptation.",
  "comments": 0,
  "user": null,
  "comments_enabled": true,
  "comments_url": "https://api.github.com/gists/68b0ec322fd5e322766f041b9353f13a/comments",
  "owner": {
    "login": "ruvnet",
    "id": 2934394,
    "node_id": "MDQ6VXNlcjI5MzQzOTQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2934394?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ruvnet",
    "html_url": "https://github.com/ruvnet",
    "followers_url": "https://api.github.com/users/ruvnet/followers",
    "following_url": "https://api.github.com/users/ruvnet/following{/other_user}",
    "gists_url": "https://api.github.com/users/ruvnet/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ruvnet/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ruvnet/subscriptions",
    "organizations_url": "https://api.github.com/users/ruvnet/orgs",
    "repos_url": "https://api.github.com/users/ruvnet/repos",
    "events_url": "https://api.github.com/users/ruvnet/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ruvnet/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "forks": [
    {
      "url": "https://api.github.com/gists/f6781fe4a8b35be134d8cda4db2bbaea",
      "user": {
        "login": "n4s5ti",
        "id": 77896784,
        "node_id": "MDQ6VXNlcjc3ODk2Nzg0",
        "avatar_url": "https://avatars.githubusercontent.com/u/77896784?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/n4s5ti",
        "html_url": "https://github.com/n4s5ti",
        "followers_url": "https://api.github.com/users/n4s5ti/followers",
        "following_url": "https://api.github.com/users/n4s5ti/following{/other_user}",
        "gists_url": "https://api.github.com/users/n4s5ti/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/n4s5ti/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/n4s5ti/subscriptions",
        "organizations_url": "https://api.github.com/users/n4s5ti/orgs",
        "repos_url": "https://api.github.com/users/n4s5ti/repos",
        "events_url": "https://api.github.com/users/n4s5ti/events{/privacy}",
        "received_events_url": "https://api.github.com/users/n4s5ti/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false,
        "name": null,
        "company": null,
        "blog": "",
        "location": null,
        "email": null,
        "hireable": null,
        "bio": null,
        "twitter_username": null,
        "public_repos": 105,
        "public_gists": 103,
        "followers": 9,
        "following": 60,
        "created_at": "2021-01-23T18:37:16Z",
        "updated_at": "2026-01-20T22:26:03Z"
      },
      "id": "f6781fe4a8b35be134d8cda4db2bbaea",
      "created_at": "2025-11-07T14:22:17Z",
      "updated_at": "2025-11-11T08:34:02Z"
    }
  ],
  "history": [
    {
      "user": {
        "login": "ruvnet",
        "id": 2934394,
        "node_id": "MDQ6VXNlcjI5MzQzOTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2934394?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ruvnet",
        "html_url": "https://github.com/ruvnet",
        "followers_url": "https://api.github.com/users/ruvnet/followers",
        "following_url": "https://api.github.com/users/ruvnet/following{/other_user}",
        "gists_url": "https://api.github.com/users/ruvnet/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/ruvnet/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/ruvnet/subscriptions",
        "organizations_url": "https://api.github.com/users/ruvnet/orgs",
        "repos_url": "https://api.github.com/users/ruvnet/repos",
        "events_url": "https://api.github.com/users/ruvnet/events{/privacy}",
        "received_events_url": "https://api.github.com/users/ruvnet/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
      },
      "version": "6b146952b94a9d7b4284ef8f8a78fb3a2a315f3b",
      "committed_at": "2024-11-16T16:01:16Z",
      "change_status": {
        "total": 0,
        "additions": 0,
        "deletions": 0
      },
      "url": "https://api.github.com/gists/68b0ec322fd5e322766f041b9353f13a/6b146952b94a9d7b4284ef8f8a78fb3a2a315f3b"
    },
    {
      "user": {
        "login": "ruvnet",
        "id": 2934394,
        "node_id": "MDQ6VXNlcjI5MzQzOTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2934394?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ruvnet",
        "html_url": "https://github.com/ruvnet",
        "followers_url": "https://api.github.com/users/ruvnet/followers",
        "following_url": "https://api.github.com/users/ruvnet/following{/other_user}",
        "gists_url": "https://api.github.com/users/ruvnet/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/ruvnet/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/ruvnet/subscriptions",
        "organizations_url": "https://api.github.com/users/ruvnet/orgs",
        "repos_url": "https://api.github.com/users/ruvnet/repos",
        "events_url": "https://api.github.com/users/ruvnet/events{/privacy}",
        "received_events_url": "https://api.github.com/users/ruvnet/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
      },
      "version": "0790b8cad02959b56f37a279d24a226f6ef5b137",
      "committed_at": "2024-11-16T15:59:55Z",
      "change_status": {
        "total": 231,
        "additions": 231,
        "deletions": 0
      },
      "url": "https://api.github.com/gists/68b0ec322fd5e322766f041b9353f13a/0790b8cad02959b56f37a279d24a226f6ef5b137"
    }
  ],
  "truncated": false,
  "type": "gist",
  "commit": "6b146952b94a9d7b4284ef8f8a78fb3a2a315f3b",
  "lastUpdated": "2026-01-30T15:12:47+00:00",
  "path": "artifacts/extracted/github/gists/by-date/2024-11-16/This_example_demonstrates_basic_polymorphic_obfusc_(68b0ec322fd5e322766f041b9353f13a)"
}