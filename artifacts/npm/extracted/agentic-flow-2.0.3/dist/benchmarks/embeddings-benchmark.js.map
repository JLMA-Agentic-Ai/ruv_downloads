{"version":3,"file":"embeddings-benchmark.js","sourceRoot":"","sources":["../../src/benchmarks/embeddings-benchmark.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Embeddings Performance Benchmark Suite\n *\n * Measures performance of:\n * - O(1) LRU Cache operations\n * - Parallel batch embedding\n * - 8x unrolled cosine similarity\n * - Neural substrate operations\n * - Overall throughput\n */\n\nimport { performance } from 'perf_hooks';\nimport {\n  getOptimizedEmbedder,\n  cosineSimilarity,\n  euclideanDistance,\n  normalizeVector\n} from '../embeddings/optimized-embedder.js';\n\n// ============================================================================\n// Benchmark Utilities\n// ============================================================================\n\ninterface BenchmarkResult {\n  name: string;\n  iterations: number;\n  totalMs: number;\n  avgMs: number;\n  opsPerSec: number;\n  minMs: number;\n  maxMs: number;\n  p95Ms: number;\n}\n\nasync function benchmark(\n  name: string,\n  fn: () => Promise<void> | void,\n  iterations: number = 1000\n): Promise<BenchmarkResult> {\n  const times: number[] = [];\n\n  // Warmup\n  for (let i = 0; i < Math.min(10, iterations / 10); i++) {\n    await fn();\n  }\n\n  // Actual benchmark\n  for (let i = 0; i < iterations; i++) {\n    const start = performance.now();\n    await fn();\n    times.push(performance.now() - start);\n  }\n\n  times.sort((a, b) => a - b);\n  const totalMs = times.reduce((a, b) => a + b, 0);\n  const avgMs = totalMs / iterations;\n\n  return {\n    name,\n    iterations,\n    totalMs,\n    avgMs,\n    opsPerSec: 1000 / avgMs,\n    minMs: times[0],\n    maxMs: times[times.length - 1],\n    p95Ms: times[Math.floor(iterations * 0.95)]\n  };\n}\n\nfunction formatResult(result: BenchmarkResult): string {\n  return [\n    `  ${result.name}`,\n    `    Iterations: ${result.iterations.toLocaleString()}`,\n    `    Total: ${result.totalMs.toFixed(2)}ms`,\n    `    Avg: ${result.avgMs.toFixed(4)}ms`,\n    `    Ops/sec: ${result.opsPerSec.toFixed(2)}`,\n    `    Min: ${result.minMs.toFixed(4)}ms`,\n    `    Max: ${result.maxMs.toFixed(4)}ms`,\n    `    P95: ${result.p95Ms.toFixed(4)}ms`\n  ].join('\\n');\n}\n\n// ============================================================================\n// Vector Operation Benchmarks\n// ============================================================================\n\nasync function benchmarkCosineSimilarity(): Promise<BenchmarkResult> {\n  const dim = 384;\n  const a = new Float32Array(dim);\n  const b = new Float32Array(dim);\n\n  // Initialize with random values\n  for (let i = 0; i < dim; i++) {\n    a[i] = Math.random() - 0.5;\n    b[i] = Math.random() - 0.5;\n  }\n  normalizeVector(a);\n  normalizeVector(b);\n\n  return benchmark('Cosine Similarity (384d, 8x unrolled)', () => {\n    cosineSimilarity(a, b);\n  }, 100000);\n}\n\nasync function benchmarkEuclideanDistance(): Promise<BenchmarkResult> {\n  const dim = 384;\n  const a = new Float32Array(dim);\n  const b = new Float32Array(dim);\n\n  for (let i = 0; i < dim; i++) {\n    a[i] = Math.random() - 0.5;\n    b[i] = Math.random() - 0.5;\n  }\n\n  return benchmark('Euclidean Distance (384d)', () => {\n    euclideanDistance(a, b);\n  }, 100000);\n}\n\nasync function benchmarkNormalize(): Promise<BenchmarkResult> {\n  const dim = 384;\n  const vectors: Float32Array[] = [];\n\n  // Pre-create vectors\n  for (let i = 0; i < 1000; i++) {\n    const v = new Float32Array(dim);\n    for (let j = 0; j < dim; j++) {\n      v[j] = Math.random() - 0.5;\n    }\n    vectors.push(v);\n  }\n\n  let idx = 0;\n  return benchmark('Normalize Vector (384d)', () => {\n    normalizeVector(vectors[idx++ % 1000]);\n  }, 100000);\n}\n\n// ============================================================================\n// Cache Benchmarks\n// ============================================================================\n\nasync function benchmarkCacheOperations(): Promise<BenchmarkResult[]> {\n  const embedder = getOptimizedEmbedder();\n  await embedder.init();\n\n  const results: BenchmarkResult[] = [];\n\n  // Pre-populate cache\n  const texts = Array.from({ length: 256 }, (_, i) => `cache test text ${i}`);\n  for (const text of texts) {\n    await embedder.embed(text);\n  }\n\n  // Benchmark cache hits\n  results.push(await benchmark('Cache Hit (O(1) LRU)', async () => {\n    await embedder.embed(texts[Math.floor(Math.random() * 256)]);\n  }, 10000));\n\n  // Benchmark cache miss + embedding\n  let missIdx = 1000;\n  results.push(await benchmark('Cache Miss + Embed', async () => {\n    await embedder.embed(`unique text for miss ${missIdx++}`);\n  }, 100));\n\n  return results;\n}\n\n// ============================================================================\n// Batch Embedding Benchmarks\n// ============================================================================\n\nasync function benchmarkBatchEmbedding(): Promise<BenchmarkResult[]> {\n  const embedder = getOptimizedEmbedder();\n  await embedder.init();\n  embedder.clearCache();\n\n  const results: BenchmarkResult[] = [];\n\n  // Small batch\n  const smallBatch = Array.from({ length: 10 }, (_, i) => `small batch text ${i}`);\n  results.push(await benchmark('Batch Embed (10 texts, parallel)', async () => {\n    embedder.clearCache();\n    await embedder.embedBatch(smallBatch, 4);\n  }, 20));\n\n  // Medium batch\n  const mediumBatch = Array.from({ length: 50 }, (_, i) => `medium batch text ${i}`);\n  results.push(await benchmark('Batch Embed (50 texts, parallel)', async () => {\n    embedder.clearCache();\n    await embedder.embedBatch(mediumBatch, 4);\n  }, 10));\n\n  // Compare sequential vs parallel (simulated)\n  results.push(await benchmark('Batch Embed (10 texts, cached)', async () => {\n    await embedder.embedBatch(smallBatch, 4); // Should hit cache\n  }, 100));\n\n  return results;\n}\n\n// ============================================================================\n// Similarity Search Benchmarks\n// ============================================================================\n\nasync function benchmarkSimilaritySearch(): Promise<BenchmarkResult[]> {\n  const embedder = getOptimizedEmbedder();\n  await embedder.init();\n\n  const results: BenchmarkResult[] = [];\n\n  // Prepare candidates\n  const candidates = Array.from({ length: 100 }, (_, i) =>\n    `candidate document about topic ${i % 10} with content ${i}`\n  );\n\n  // Pre-embed candidates\n  await embedder.embedBatch(candidates, 4);\n\n  results.push(await benchmark('Find Similar (100 candidates, top-5)', async () => {\n    await embedder.findSimilar('search query about topic 5', candidates, 5);\n  }, 50));\n\n  return results;\n}\n\n// ============================================================================\n// Memory Pressure Test\n// ============================================================================\n\nasync function benchmarkMemoryPressure(): Promise<{\n  heapBefore: number;\n  heapAfter: number;\n  heapDelta: number;\n  gcPauses: number;\n}> {\n  const embedder = getOptimizedEmbedder();\n  await embedder.init();\n  embedder.clearCache();\n\n  // Force GC if available\n  if (global.gc) global.gc();\n\n  const heapBefore = process.memoryUsage().heapUsed;\n  let gcPauses = 0;\n\n  // Generate 1000 embeddings\n  for (let i = 0; i < 1000; i++) {\n    await embedder.embed(`memory pressure test text ${i} with some content`);\n\n    // Detect potential GC pauses\n    const start = performance.now();\n    await new Promise(resolve => setImmediate(resolve));\n    if (performance.now() - start > 5) gcPauses++;\n  }\n\n  const heapAfter = process.memoryUsage().heapUsed;\n\n  return {\n    heapBefore,\n    heapAfter,\n    heapDelta: heapAfter - heapBefore,\n    gcPauses\n  };\n}\n\n// ============================================================================\n// Throughput Test\n// ============================================================================\n\nasync function benchmarkThroughput(): Promise<{\n  textsProcessed: number;\n  totalTimeMs: number;\n  textsPerSecond: number;\n}> {\n  const embedder = getOptimizedEmbedder();\n  await embedder.init();\n  embedder.clearCache();\n\n  const texts = Array.from({ length: 100 }, (_, i) =>\n    `throughput test document ${i} with varying content length ${i * 10}`\n  );\n\n  const start = performance.now();\n  await embedder.embedBatch(texts, 4);\n  const totalTimeMs = performance.now() - start;\n\n  return {\n    textsProcessed: texts.length,\n    totalTimeMs,\n    textsPerSecond: (texts.length / totalTimeMs) * 1000\n  };\n}\n\n// ============================================================================\n// Main Benchmark Runner\n// ============================================================================\n\nasync function runBenchmarks() {\n  console.log('\\n' + '='.repeat(70));\n  console.log('  EMBEDDINGS PERFORMANCE BENCHMARK SUITE');\n  console.log('  agentic-flow v2.0.1-alpha.50');\n  console.log('='.repeat(70) + '\\n');\n\n  const allResults: BenchmarkResult[] = [];\n\n  // Vector Operations\n  console.log('üìê Vector Operations\\n');\n\n  const cosineSim = await benchmarkCosineSimilarity();\n  console.log(formatResult(cosineSim) + '\\n');\n  allResults.push(cosineSim);\n\n  const euclidean = await benchmarkEuclideanDistance();\n  console.log(formatResult(euclidean) + '\\n');\n  allResults.push(euclidean);\n\n  const normalize = await benchmarkNormalize();\n  console.log(formatResult(normalize) + '\\n');\n  allResults.push(normalize);\n\n  // Cache Operations\n  console.log('\\nüíæ Cache Operations (O(1) LRU)\\n');\n\n  const cacheResults = await benchmarkCacheOperations();\n  for (const result of cacheResults) {\n    console.log(formatResult(result) + '\\n');\n    allResults.push(result);\n  }\n\n  // Batch Embedding\n  console.log('\\n‚ö° Batch Embedding (Parallel Processing)\\n');\n\n  const batchResults = await benchmarkBatchEmbedding();\n  for (const result of batchResults) {\n    console.log(formatResult(result) + '\\n');\n    allResults.push(result);\n  }\n\n  // Similarity Search\n  console.log('\\nüîç Similarity Search\\n');\n\n  const searchResults = await benchmarkSimilaritySearch();\n  for (const result of searchResults) {\n    console.log(formatResult(result) + '\\n');\n    allResults.push(result);\n  }\n\n  // Memory Pressure\n  console.log('\\nüß† Memory Pressure Test\\n');\n\n  const memoryResult = await benchmarkMemoryPressure();\n  console.log(`  Heap Before: ${(memoryResult.heapBefore / 1024 / 1024).toFixed(2)} MB`);\n  console.log(`  Heap After: ${(memoryResult.heapAfter / 1024 / 1024).toFixed(2)} MB`);\n  console.log(`  Heap Delta: ${(memoryResult.heapDelta / 1024 / 1024).toFixed(2)} MB`);\n  console.log(`  Potential GC Pauses: ${memoryResult.gcPauses}\\n`);\n\n  // Throughput\n  console.log('\\nüöÄ Throughput Test\\n');\n\n  const throughput = await benchmarkThroughput();\n  console.log(`  Texts Processed: ${throughput.textsProcessed}`);\n  console.log(`  Total Time: ${throughput.totalTimeMs.toFixed(2)} ms`);\n  console.log(`  Throughput: ${throughput.textsPerSecond.toFixed(2)} texts/sec\\n`);\n\n  // Summary\n  console.log('\\n' + '='.repeat(70));\n  console.log('  BENCHMARK SUMMARY');\n  console.log('='.repeat(70) + '\\n');\n\n  console.log('  Key Metrics:');\n  console.log(`    ‚Ä¢ Cosine Similarity: ${cosineSim.opsPerSec.toFixed(0)} ops/sec`);\n  console.log(`    ‚Ä¢ Cache Hit: ${cacheResults[0].opsPerSec.toFixed(0)} ops/sec`);\n  console.log(`    ‚Ä¢ Batch Throughput: ${throughput.textsPerSecond.toFixed(1)} texts/sec`);\n  console.log(`    ‚Ä¢ Memory Efficiency: ${(memoryResult.heapDelta / 1024).toFixed(1)} KB for 1000 embeds`);\n\n  console.log('\\n  Performance Characteristics:');\n  console.log('    ‚úì O(1) LRU cache operations');\n  console.log('    ‚úì 8x loop unrolling with ILP');\n  console.log('    ‚úì Parallel batch processing');\n  console.log('    ‚úì Pre-allocated tensor buffers');\n  console.log('    ‚úì Minimal GC pressure\\n');\n\n  return { results: allResults, memory: memoryResult, throughput };\n}\n\n// Run if executed directly\nrunBenchmarks().catch(console.error);\n\nexport { runBenchmarks, benchmark };\nexport type { BenchmarkResult };\n"]}