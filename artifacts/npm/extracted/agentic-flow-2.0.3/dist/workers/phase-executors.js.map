{"version":3,"file":"phase-executors.js","sourceRoot":"","sources":["../../src/workers/phase-executors.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Phase Executors - Composable analysis phases for custom workers\n *\n * REFACTORED: Core phases are now in consolidated-phases.ts to eliminate duplication.\n * This module provides backwards compatibility and additional specialized phases.\n */\n\nimport { WorkerContext } from './types.js';\nimport { PhaseConfig, PhaseResult } from './custom-worker-config.js';\nimport {\n  UnifiedPhaseContext,\n  createUnifiedContext,\n  getUnifiedPhase,\n  listUnifiedPhases\n} from './consolidated-phases.js';\n\n// Re-export context types for backwards compatibility\nexport type PhaseContext = UnifiedPhaseContext;\nexport const createPhaseContext = createUnifiedContext;\n\n// ============================================================================\n// Phase Executor Registry - Delegates to consolidated phases\n// ============================================================================\n\nexport type PhaseExecutor = (\n  workerContext: WorkerContext,\n  phaseContext: PhaseContext,\n  options: Record<string, unknown>\n) => Promise<PhaseResult>;\n\nconst executors = new Map<string, PhaseExecutor>();\n\nexport function registerPhaseExecutor(type: string, executor: PhaseExecutor): void {\n  executors.set(type, executor);\n}\n\nexport function getPhaseExecutor(type: string): PhaseExecutor | undefined {\n  // First check consolidated phases (primary)\n  const unified = getUnifiedPhase(type);\n  if (unified) return unified;\n  // Then check local registry (specialized phases)\n  return executors.get(type);\n}\n\nexport function listPhaseExecutors(): string[] {\n  const unifiedPhases = listUnifiedPhases();\n  const localPhases = Array.from(executors.keys());\n  return [...new Set([...unifiedPhases, ...localPhases])];\n}\n\n// ============================================================================\n// Specialized Discovery Phases (not in consolidated)\n// ============================================================================\n\nregisterPhaseExecutor('pattern-discovery', async (workerContext, phaseContext, options) => {\n  const fs = await import('fs/promises');\n  const path = await import('path');\n  const patterns = (options.patterns as string[]) || [];\n  const topic = workerContext.topic?.toLowerCase() || '';\n\n  const foundPatterns: string[] = [];\n\n  for (const file of phaseContext.files.slice(0, 50)) {\n    try {\n      const content = await fs.readFile(path.join(process.cwd(), file), 'utf-8');\n      phaseContext.bytes += content.length;\n\n      // Search for topic mentions\n      if (topic) {\n        const lines = content.split('\\n');\n        lines.forEach((line, i) => {\n          if (line.toLowerCase().includes(topic)) {\n            foundPatterns.push(`${file}:${i + 1}: ${line.trim().slice(0, 80)}`);\n          }\n        });\n      }\n\n      // Search for custom patterns\n      for (const pattern of patterns) {\n        const regex = new RegExp(pattern, 'gi');\n        const matches = content.match(regex);\n        if (matches) {\n          foundPatterns.push(`${file}: ${matches.length} matches for \"${pattern}\"`);\n        }\n      }\n    } catch { /* skip unreadable files */ }\n  }\n\n  phaseContext.patterns.push(...foundPatterns);\n  return {\n    success: true,\n    data: { patternsFound: foundPatterns.length },\n    patterns: foundPatterns\n  };\n});\n\n// dependency-discovery and api-discovery are now in consolidated-phases.ts\n\n// ============================================================================\n// Analysis Phases\n// ============================================================================\n\nregisterPhaseExecutor('static-analysis', async (workerContext, phaseContext, options) => {\n  const fs = await import('fs/promises');\n  const path = await import('path');\n\n  const stats = {\n    functions: 0,\n    classes: 0,\n    exports: 0,\n    imports: 0,\n    comments: 0,\n    todos: 0\n  };\n\n  for (const file of phaseContext.files.slice(0, 50)) {\n    try {\n      const content = await fs.readFile(path.join(process.cwd(), file), 'utf-8');\n      phaseContext.bytes += content.length;\n\n      stats.functions += (content.match(/function\\s+\\w+|=>\\s*{|\\(\\)\\s*{/g) || []).length;\n      stats.classes += (content.match(/class\\s+\\w+/g) || []).length;\n      stats.exports += (content.match(/export\\s+(default\\s+)?(function|class|const|let|var)/g) || []).length;\n      stats.imports += (content.match(/import\\s+/g) || []).length;\n      stats.comments += (content.match(/\\/\\/|\\/\\*|\\*\\//g) || []).length;\n      stats.todos += (content.match(/TODO|FIXME|HACK|XXX/gi) || []).length;\n\n      if (stats.todos > 0) {\n        const todoMatches = content.match(/\\/\\/\\s*(TODO|FIXME|HACK|XXX):.*/gi) || [];\n        phaseContext.patterns.push(...todoMatches.slice(0, 5).map(t => `${file}: ${t.trim()}`));\n      }\n    } catch { /* skip */ }\n  }\n\n  Object.entries(stats).forEach(([key, val]) => {\n    phaseContext.metrics[key] = val;\n  });\n\n  return {\n    success: true,\n    data: stats\n  };\n});\n\n// complexity-analysis and security-analysis are now in consolidated-phases.ts\n\nregisterPhaseExecutor('performance-analysis', async (workerContext, phaseContext, options) => {\n  const fs = await import('fs/promises');\n  const path = await import('path');\n\n  const warnings: Array<{ file: string; type: string; line: number }> = [];\n  const perfPatterns = [\n    { pattern: /\\.forEach\\s*\\(/gi, type: 'forEach-in-hot-path' },\n    { pattern: /JSON\\.parse\\s*\\(.*JSON\\.stringify/gi, type: 'deep-clone' },\n    { pattern: /new\\s+RegExp\\s*\\(/gi, type: 'dynamic-regex' },\n    { pattern: /async\\s+.*\\.map\\s*\\(/gi, type: 'async-in-loop' },\n    { pattern: /await\\s+.*\\.forEach/gi, type: 'await-forEach' }\n  ];\n\n  for (const file of phaseContext.files.slice(0, 50)) {\n    try {\n      const content = await fs.readFile(path.join(process.cwd(), file), 'utf-8');\n      const lines = content.split('\\n');\n      phaseContext.bytes += content.length;\n\n      lines.forEach((line, i) => {\n        for (const { pattern, type } of perfPatterns) {\n          pattern.lastIndex = 0;\n          if (pattern.test(line)) {\n            warnings.push({ file, type, line: i + 1 });\n          }\n        }\n      });\n    } catch { /* skip */ }\n  }\n\n  phaseContext.patterns.push(...warnings.map(w => `[perf] ${w.type}: ${w.file}:${w.line}`));\n  phaseContext.metrics['perf_warnings'] = warnings.length;\n\n  return {\n    success: true,\n    data: { warnings, count: warnings.length }\n  };\n});\n\nregisterPhaseExecutor('import-analysis', async (workerContext, phaseContext, options) => {\n  const fs = await import('fs/promises');\n  const path = await import('path');\n\n  const imports: Record<string, number> = {};\n\n  for (const file of phaseContext.files.slice(0, 100)) {\n    try {\n      const content = await fs.readFile(path.join(process.cwd(), file), 'utf-8');\n      phaseContext.bytes += content.length;\n\n      const importMatches = content.match(/from\\s+['\"]([^'\"]+)['\"]/g) || [];\n      for (const match of importMatches) {\n        const pkg = match.replace(/from\\s+['\"]/, '').replace(/['\"]/, '');\n        imports[pkg] = (imports[pkg] || 0) + 1;\n      }\n    } catch { /* skip */ }\n  }\n\n  const sorted = Object.entries(imports).sort((a, b) => b[1] - a[1]);\n  phaseContext.patterns.push(...sorted.slice(0, 10).map(([pkg, count]) => `${pkg}: ${count} imports`));\n  phaseContext.metrics['unique_imports'] = Object.keys(imports).length;\n\n  return {\n    success: true,\n    data: { imports: Object.fromEntries(sorted.slice(0, 20)) }\n  };\n});\n\nregisterPhaseExecutor('type-analysis', async (workerContext, phaseContext, options) => {\n  const fs = await import('fs/promises');\n  const path = await import('path');\n\n  const types: Array<{ name: string; file: string; kind: string }> = [];\n\n  for (const file of phaseContext.files.filter(f => f.endsWith('.ts') || f.endsWith('.tsx')).slice(0, 50)) {\n    try {\n      const content = await fs.readFile(path.join(process.cwd(), file), 'utf-8');\n      phaseContext.bytes += content.length;\n\n      // Extract interfaces\n      const interfaces = content.match(/interface\\s+(\\w+)/g) || [];\n      types.push(...interfaces.map(i => ({\n        name: i.replace('interface ', ''),\n        file,\n        kind: 'interface'\n      })));\n\n      // Extract types\n      const typeAliases = content.match(/type\\s+(\\w+)\\s*=/g) || [];\n      types.push(...typeAliases.map(t => ({\n        name: t.replace(/type\\s+/, '').replace(/\\s*=/, ''),\n        file,\n        kind: 'type'\n      })));\n\n      // Extract enums\n      const enums = content.match(/enum\\s+(\\w+)/g) || [];\n      types.push(...enums.map(e => ({\n        name: e.replace('enum ', ''),\n        file,\n        kind: 'enum'\n      })));\n    } catch { /* skip */ }\n  }\n\n  phaseContext.patterns.push(...types.slice(0, 20).map(t => `${t.kind} ${t.name} (${t.file})`));\n  phaseContext.metrics['types_found'] = types.length;\n\n  return {\n    success: true,\n    data: { types, count: types.length }\n  };\n});\n\n// ============================================================================\n// Pattern Extraction Phases (unique ones not in consolidated)\n// ============================================================================\n\n// pattern-extraction and todo-extraction are now in consolidated-phases.ts\n\nregisterPhaseExecutor('secret-detection', async (workerContext, phaseContext, options) => {\n  const fs = await import('fs/promises');\n  const path = await import('path');\n\n  const secrets: Array<{ file: string; line: number; type: string }> = [];\n  const secretPatterns = [\n    { pattern: /api[_-]?key\\s*[:=]\\s*['\"][^'\"]{10,}['\"]/gi, type: 'api-key' },\n    { pattern: /password\\s*[:=]\\s*['\"][^'\"]+['\"]/gi, type: 'password' },\n    { pattern: /secret\\s*[:=]\\s*['\"][^'\"]{10,}['\"]/gi, type: 'secret' },\n    { pattern: /token\\s*[:=]\\s*['\"][^'\"]{20,}['\"]/gi, type: 'token' },\n    { pattern: /private[_-]?key/gi, type: 'private-key' },\n    { pattern: /-----BEGIN.*PRIVATE KEY-----/gi, type: 'pem-key' },\n    { pattern: /Bearer\\s+[a-zA-Z0-9_-]{20,}/gi, type: 'bearer-token' },\n    { pattern: /ghp_[a-zA-Z0-9]{36}/gi, type: 'github-token' },\n    { pattern: /sk-[a-zA-Z0-9]{32,}/gi, type: 'openai-key' }\n  ];\n\n  for (const file of phaseContext.files.slice(0, 200)) {\n    // Skip common safe files\n    if (file.includes('.test.') || file.includes('.spec.') || file.includes('mock')) continue;\n\n    try {\n      const content = await fs.readFile(path.join(process.cwd(), file), 'utf-8');\n      const lines = content.split('\\n');\n      phaseContext.bytes += content.length;\n\n      lines.forEach((line, i) => {\n        for (const { pattern, type } of secretPatterns) {\n          pattern.lastIndex = 0;\n          if (pattern.test(line)) {\n            secrets.push({ file, line: i + 1, type });\n          }\n        }\n      });\n    } catch { /* skip */ }\n  }\n\n  phaseContext.patterns.push(...secrets.map(s => `[SECRET] ${s.type} in ${s.file}:${s.line}`));\n  phaseContext.metrics['secrets_found'] = secrets.length;\n\n  return {\n    success: true,\n    data: {\n      secrets: secrets.slice(0, 20),\n      count: secrets.length,\n      riskLevel: secrets.length > 5 ? 'high' : secrets.length > 0 ? 'medium' : 'low'\n    }\n  };\n});\n\nregisterPhaseExecutor('code-smell-detection', async (workerContext, phaseContext, options) => {\n  const fs = await import('fs/promises');\n  const path = await import('path');\n\n  const smells: Array<{ file: string; type: string; line: number }> = [];\n  const smellPatterns = [\n    { pattern: /console\\.(log|debug|info)\\s*\\(/gi, type: 'console-log' },\n    { pattern: /debugger;/gi, type: 'debugger' },\n    { pattern: /\\/\\/\\s*@ts-ignore/gi, type: 'ts-ignore' },\n    { pattern: /any(?:\\s|[,;>)\\]])/gi, type: 'any-type' },\n    { pattern: /eslint-disable/gi, type: 'eslint-disable' },\n    { pattern: /\\s{4,}function|\\s{4,}=>/gi, type: 'deep-nesting' }\n  ];\n\n  for (const file of phaseContext.files.slice(0, 50)) {\n    try {\n      const content = await fs.readFile(path.join(process.cwd(), file), 'utf-8');\n      const lines = content.split('\\n');\n      phaseContext.bytes += content.length;\n\n      lines.forEach((line, i) => {\n        for (const { pattern, type } of smellPatterns) {\n          pattern.lastIndex = 0;\n          if (pattern.test(line)) {\n            smells.push({ file, type, line: i + 1 });\n          }\n        }\n      });\n    } catch { /* skip */ }\n  }\n\n  phaseContext.patterns.push(...smells.slice(0, 20).map(s => `[smell] ${s.type}: ${s.file}:${s.line}`));\n  phaseContext.metrics['code_smells'] = smells.length;\n\n  return {\n    success: true,\n    data: { smells: smells.slice(0, 30), count: smells.length }\n  };\n});\n\n// ============================================================================\n// Build Phases\n// ============================================================================\n\nregisterPhaseExecutor('graph-build', async (workerContext, phaseContext, options) => {\n  // Build on dependency-discovery results\n  const graph: Record<string, string[]> = {};\n\n  for (const [file, deps] of phaseContext.dependencies) {\n    graph[file] = deps;\n  }\n\n  const nodes = Object.keys(graph).length;\n  const edges = Object.values(graph).flat().length;\n\n  phaseContext.patterns.push(`Dependency graph: ${nodes} nodes, ${edges} edges`);\n  phaseContext.metrics['graph_nodes'] = nodes;\n  phaseContext.metrics['graph_edges'] = edges;\n\n  return {\n    success: true,\n    data: { nodes, edges, graph: Object.fromEntries(Object.entries(graph).slice(0, 20)) }\n  };\n});\n\nregisterPhaseExecutor('call-graph', async (workerContext, phaseContext, options) => {\n  const fs = await import('fs/promises');\n  const path = await import('path');\n\n  const calls: Record<string, string[]> = {};\n\n  for (const file of phaseContext.files.slice(0, 30)) {\n    try {\n      const content = await fs.readFile(path.join(process.cwd(), file), 'utf-8');\n      phaseContext.bytes += content.length;\n\n      // Extract function definitions\n      const funcDefs = content.match(/(?:function\\s+|const\\s+|let\\s+|var\\s+)(\\w+)\\s*(?:=\\s*(?:async\\s*)?\\([^)]*\\)\\s*=>|\\s*=\\s*function|\\s*\\([^)]*\\)\\s*{)/g) || [];\n      const funcNames = funcDefs.map(f => {\n        const match = f.match(/(?:function\\s+|const\\s+|let\\s+|var\\s+)(\\w+)/);\n        return match ? match[1] : '';\n      }).filter(Boolean);\n\n      // Extract function calls\n      const funcCalls = content.match(/\\b\\w+\\s*\\(/g) || [];\n      const calledFuncs = funcCalls.map(c => c.replace(/\\s*\\(/, '')).filter(Boolean);\n\n      calls[file] = [...new Set(calledFuncs)];\n    } catch { /* skip */ }\n  }\n\n  phaseContext.metrics['call_graph_files'] = Object.keys(calls).length;\n\n  return {\n    success: true,\n    data: { callGraph: calls }\n  };\n});\n\nregisterPhaseExecutor('dependency-graph', async (workerContext, phaseContext, options) => {\n  // Alias for graph-build\n  return getPhaseExecutor('graph-build')!(workerContext, phaseContext, options);\n});\n\n// ============================================================================\n// Learning Phases\n// ============================================================================\n\nregisterPhaseExecutor('vectorization', async (workerContext, phaseContext, options) => {\n  // Placeholder - actual vectorization happens in RuVector integration\n  phaseContext.patterns.push(`Vectorization: ${phaseContext.patterns.length} patterns ready`);\n  return {\n    success: true,\n    data: { patternsForVectorization: phaseContext.patterns.length }\n  };\n});\n\n// embedding-generation is now in consolidated-phases.ts with real ONNX implementation\n\nregisterPhaseExecutor('pattern-storage', async (workerContext, phaseContext, options) => {\n  // Placeholder - storage happens in RuVector/ReasoningBank\n  phaseContext.patterns.push(`Pattern storage: ${phaseContext.patterns.length} patterns`);\n  return {\n    success: true,\n    data: { patternsStored: phaseContext.patterns.length }\n  };\n});\n\nregisterPhaseExecutor('sona-training', async (workerContext, phaseContext, options) => {\n  // Placeholder - SONA training happens in RuVector integration\n  phaseContext.patterns.push('SONA training triggered');\n  return {\n    success: true,\n    data: { sonaTrainingTriggered: true }\n  };\n});\n\n// ============================================================================\n// Output Phases (summarization is in consolidated-phases.ts)\n// ============================================================================\n\nregisterPhaseExecutor('report-generation', async (workerContext, phaseContext, options) => {\n  const report = {\n    workerId: workerContext.workerId,\n    trigger: workerContext.trigger,\n    topic: workerContext.topic,\n    timestamp: new Date().toISOString(),\n    summary: {\n      filesAnalyzed: phaseContext.files.length,\n      patternsFound: phaseContext.patterns.length,\n      bytesProcessed: phaseContext.bytes\n    },\n    metrics: phaseContext.metrics,\n    topPatterns: phaseContext.patterns.slice(0, 20),\n    phaseData: Object.fromEntries(phaseContext.phaseData)\n  };\n\n  return {\n    success: true,\n    data: { report }\n  };\n});\n\nregisterPhaseExecutor('indexing', async (workerContext, phaseContext, options) => {\n  phaseContext.patterns.push(`Indexed ${phaseContext.files.length} files`);\n  return {\n    success: true,\n    data: { indexed: phaseContext.files.length }\n  };\n});\n\n// ============================================================================\n// Execute Phase Pipeline\n// ============================================================================\n\nexport async function executePhasePipeline(\n  workerContext: WorkerContext,\n  phases: PhaseConfig[],\n  onProgress?: (phase: string, progress: number) => void\n): Promise<{\n  success: boolean;\n  phaseContext: PhaseContext;\n  results: Map<string, PhaseResult>;\n  errors: string[];\n}> {\n  const phaseContext = createPhaseContext();\n  const results = new Map<string, PhaseResult>();\n  const errors: string[] = [];\n\n  for (let i = 0; i < phases.length; i++) {\n    if (workerContext.signal.aborted) {\n      errors.push('Pipeline aborted');\n      break;\n    }\n\n    const phase = phases[i];\n    const phaseName = phase.name || phase.type;\n\n    onProgress?.(phaseName, Math.round((i / phases.length) * 100));\n\n    const executor = phase.type === 'custom' && phase.executor\n      ? async (ctx: WorkerContext, pCtx: PhaseContext, opts: Record<string, unknown>) => {\n          return phase.executor!(ctx, opts);\n        }\n      : getPhaseExecutor(phase.type);\n\n    if (!executor) {\n      errors.push(`Unknown phase type: ${phase.type}`);\n      continue;\n    }\n\n    try {\n      const result = await Promise.race([\n        executor(workerContext, phaseContext, phase.options || {}),\n        new Promise<PhaseResult>((_, reject) =>\n          setTimeout(() => reject(new Error('Phase timeout')), phase.timeout || 60000)\n        )\n      ]);\n\n      results.set(phaseName, result);\n      phaseContext.phaseData.set(phaseName, result.data);\n\n      if (!result.success) {\n        errors.push(`Phase ${phaseName} failed: ${result.error || 'Unknown error'}`);\n      }\n    } catch (error) {\n      const errMsg = error instanceof Error ? error.message : 'Phase execution failed';\n      errors.push(`Phase ${phaseName}: ${errMsg}`);\n      results.set(phaseName, { success: false, data: {}, error: errMsg });\n    }\n  }\n\n  onProgress?.('complete', 100);\n\n  return {\n    success: errors.length === 0,\n    phaseContext,\n    results,\n    errors\n  };\n}\n"]}