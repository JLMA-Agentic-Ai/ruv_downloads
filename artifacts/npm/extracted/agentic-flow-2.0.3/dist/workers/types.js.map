{"version":3,"file":"types.js","sourceRoot":"","sources":["../../src/workers/types.ts"],"names":[],"mappings":"AAAA;;;GAGG","sourcesContent":["/**\n * Background Workers Type Definitions\n * Non-blocking workers triggered by keywords that run silently\n */\n\nexport type WorkerId = string;\nexport type WorkerTrigger =\n  | 'ultralearn'\n  | 'optimize'\n  | 'consolidate'\n  | 'predict'\n  | 'audit'\n  | 'map'\n  | 'preload'\n  | 'deepdive'\n  | 'document'\n  | 'refactor'\n  | 'benchmark'\n  | 'testgaps';\n\nexport type WorkerStatus = 'queued' | 'running' | 'complete' | 'failed' | 'cancelled' | 'timeout';\nexport type WorkerPriority = 'low' | 'medium' | 'high' | 'critical';\n\nexport interface TriggerConfig {\n  keyword: WorkerTrigger;\n  worker: string;\n  priority: WorkerPriority;\n  maxAgents: number;\n  timeout: number;\n  cooldown: number;\n  topicExtractor: RegExp | null;\n  description: string;\n}\n\nexport interface DetectedTrigger {\n  keyword: WorkerTrigger;\n  topic: string | null;\n  config: TriggerConfig;\n  detectedAt: number;\n}\n\nexport interface WorkerInfo {\n  id: WorkerId;\n  trigger: WorkerTrigger;\n  topic: string | null;\n  sessionId: string;\n  status: WorkerStatus;\n  progress: number;\n  currentPhase: string | null;\n  startedAt: number;\n  completedAt: number | null;\n  error: string | null;\n  memoryDeposits: number;\n  resultKeys: string[];\n  createdAt: number;\n  /** Actual analysis results from worker execution */\n  results?: {\n    files_analyzed?: number;\n    patterns_found?: number;\n    bytes_processed?: number;\n    sample_patterns?: string[];\n    [key: string]: unknown;\n  };\n}\n\nexport interface WorkerResults {\n  status: WorkerStatus;\n  success?: boolean;\n  data?: Record<string, unknown>;\n  error?: string;\n  completedPhases: number;\n  totalPhases: number;\n  memoryKeys: string[];\n  duration: number;\n  tokensUsed?: number;\n}\n\nexport interface PhaseResult {\n  phase: string;\n  success: boolean;\n  data?: Record<string, unknown>;\n  error?: string;\n  duration: number;\n  memoryKeys?: string[];\n}\n\nexport interface ResourceLimits {\n  maxConcurrentWorkers: number;\n  maxPerTrigger: number;\n  maxHeapMB: number;\n  workerTimeout: number;\n}\n\nexport interface ResourceStats {\n  activeWorkers: number;\n  workersByType: Record<string, number>;\n  memoryUsage: NodeJS.MemoryUsage;\n  uptime: number;\n}\n\nexport interface MemoryEntry {\n  collection: string;\n  key: string;\n  data: unknown;\n  vector?: number[];\n  ttl?: number;\n  metadata?: Record<string, unknown>;\n}\n\nexport interface SearchResult {\n  collection: string;\n  key: string;\n  data: unknown;\n  score: number;\n}\n\nexport interface ContextInjection {\n  context: Array<{\n    source: string;\n    type: string;\n    content: string;\n    score: number;\n  }>;\n  source: string;\n  confidence: number;\n}\n\nexport interface WorkerMetrics {\n  workerId: WorkerId;\n  filesAnalyzed: number;\n  patternsFound: number;\n  memoryBytesWritten: number;\n  cpuTimeMs: number;\n  peakMemoryMB: number;\n  errorCount: number;\n}\n\nexport interface DashboardMetrics {\n  totalSpawned: number;\n  totalCompleted: number;\n  totalFailed: number;\n  avgDurationMs: number;\n  p95DurationMs: number;\n  peakConcurrency: number;\n  avgMemoryMB: number;\n  peakMemoryMB: number;\n  patternsStored: number;\n  memoryDeposits: number;\n  contextInjections: number;\n  byTrigger: Record<string, { count: number; avgDuration: number; successRate: number }>;\n}\n\n// Worker execution context\nexport interface WorkerContext {\n  workerId: WorkerId;\n  trigger: WorkerTrigger;\n  topic: string | null;\n  sessionId: string;\n  startTime: number;\n  signal: AbortSignal;\n  onProgress: (progress: number, phase: string) => void;\n  onMemoryDeposit: (key: string) => void;\n}\n\n// Configuration for worker pool\nexport interface PoolConfig {\n  maxPoolSize: number;\n  preWarmCount: number;\n  idleTimeout: number;\n}\n"]}