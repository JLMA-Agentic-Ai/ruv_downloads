{"version":3,"file":"worker-agent-integration.js","sourceRoot":"","sources":["../../src/workers/worker-agent-integration.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Worker-Agent Integration Layer\n *\n * Bridges the worker system with agent execution through:\n * - Pattern sharing via ReasoningBank\n * - Metrics-based capability matching\n * - Self-learning feedback loops\n * - Performance-aware agent selection\n */\n\nimport { WorkerInfo, WorkerTrigger, WorkerResults, WorkerContext } from './types.js';\nimport { getWorkerRegistry } from './worker-registry.js';\nimport { modelCache } from '../utils/model-cache.js';\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport interface AgentCapability {\n  name: string;\n  description: string;\n  triggers: WorkerTrigger[];\n  priority: 'low' | 'medium' | 'high' | 'critical';\n  memoryPatterns: string[];\n  benchmarkThresholds: BenchmarkThreshold[];\n}\n\nexport interface BenchmarkThreshold {\n  metric: string;\n  target: number;\n  unit: 'ms' | 'ops/s' | 'MB' | '%';\n  direction: 'below' | 'above';\n}\n\nexport interface AgentPerformanceProfile {\n  agentName: string;\n  capabilities: string[];\n  avgLatencyMs: number;\n  p95LatencyMs: number;\n  successRate: number;\n  memoryUsageMB: number;\n  qualityScore: number;\n  executionCount: number;\n  lastExecuted: number;\n}\n\nexport interface WorkerAgentMapping {\n  trigger: WorkerTrigger;\n  recommendedAgents: string[];\n  fallbackAgents: string[];\n  pipelinePhases: string[];\n  memoryKeyPattern: string;\n}\n\n// ============================================================================\n// Agent Capability Registry\n// ============================================================================\n\nconst AGENT_CAPABILITIES: Map<string, AgentCapability> = new Map([\n  ['researcher', {\n    name: 'researcher',\n    description: 'Deep research and pattern discovery',\n    triggers: ['ultralearn', 'deepdive', 'map'],\n    priority: 'high',\n    memoryPatterns: ['research/*', 'patterns/*', 'context/*'],\n    benchmarkThresholds: [\n      { metric: 'p95_latency', target: 500, unit: 'ms', direction: 'below' },\n      { metric: 'memory_mb', target: 256, unit: 'MB', direction: 'below' }\n    ]\n  }],\n  ['coder', {\n    name: 'coder',\n    description: 'Code implementation and optimization',\n    triggers: ['optimize', 'refactor'],\n    priority: 'high',\n    memoryPatterns: ['code/*', 'implementations/*', 'patterns/code/*'],\n    benchmarkThresholds: [\n      { metric: 'p95_latency', target: 300, unit: 'ms', direction: 'below' },\n      { metric: 'quality_score', target: 0.85, unit: '%', direction: 'above' }\n    ]\n  }],\n  ['tester', {\n    name: 'tester',\n    description: 'Test coverage and gap analysis',\n    triggers: ['testgaps', 'audit'],\n    priority: 'medium',\n    memoryPatterns: ['tests/*', 'coverage/*', 'quality/*'],\n    benchmarkThresholds: [\n      { metric: 'coverage', target: 80, unit: '%', direction: 'above' },\n      { metric: 'p95_latency', target: 400, unit: 'ms', direction: 'below' }\n    ]\n  }],\n  ['security-analyst', {\n    name: 'security-analyst',\n    description: 'Security analysis and vulnerability detection',\n    triggers: ['audit', 'deepdive'],\n    priority: 'critical',\n    memoryPatterns: ['security/*', 'vulnerabilities/*', 'audit/*'],\n    benchmarkThresholds: [\n      { metric: 'scan_coverage', target: 95, unit: '%', direction: 'above' },\n      { metric: 'p95_latency', target: 1000, unit: 'ms', direction: 'below' }\n    ]\n  }],\n  ['performance-analyzer', {\n    name: 'performance-analyzer',\n    description: 'Performance analysis and optimization recommendations',\n    triggers: ['benchmark', 'optimize'],\n    priority: 'medium',\n    memoryPatterns: ['performance/*', 'metrics/*', 'benchmarks/*'],\n    benchmarkThresholds: [\n      { metric: 'analysis_depth', target: 10, unit: 'ops/s', direction: 'above' }\n    ]\n  }],\n  ['documenter', {\n    name: 'documenter',\n    description: 'Documentation generation and maintenance',\n    triggers: ['document'],\n    priority: 'low',\n    memoryPatterns: ['docs/*', 'api/*', 'readme/*'],\n    benchmarkThresholds: [\n      { metric: 'p95_latency', target: 600, unit: 'ms', direction: 'below' }\n    ]\n  }]\n]);\n\n// ============================================================================\n// Worker-Agent Mappings\n// ============================================================================\n\nconst WORKER_AGENT_MAPPINGS: Map<WorkerTrigger, WorkerAgentMapping> = new Map([\n  ['ultralearn', {\n    trigger: 'ultralearn',\n    recommendedAgents: ['researcher', 'coder'],\n    fallbackAgents: ['planner'],\n    pipelinePhases: ['file-discovery', 'pattern-discovery', 'vectorization', 'summarization'],\n    memoryKeyPattern: 'ultralearn/{topic}/{phase}'\n  }],\n  ['optimize', {\n    trigger: 'optimize',\n    recommendedAgents: ['performance-analyzer', 'coder'],\n    fallbackAgents: ['researcher'],\n    pipelinePhases: ['static-analysis', 'performance-analysis', 'pattern-extraction'],\n    memoryKeyPattern: 'optimize/{topic}/{metric}'\n  }],\n  ['audit', {\n    trigger: 'audit',\n    recommendedAgents: ['security-analyst', 'tester'],\n    fallbackAgents: ['reviewer'],\n    pipelinePhases: ['security-analysis', 'secret-detection', 'vulnerability-scan'],\n    memoryKeyPattern: 'audit/{topic}/{finding}'\n  }],\n  ['benchmark', {\n    trigger: 'benchmark',\n    recommendedAgents: ['performance-analyzer'],\n    fallbackAgents: ['coder', 'tester'],\n    pipelinePhases: ['performance-analysis', 'metrics-collection', 'report-generation'],\n    memoryKeyPattern: 'benchmark/{topic}/{metric}'\n  }],\n  ['testgaps', {\n    trigger: 'testgaps',\n    recommendedAgents: ['tester'],\n    fallbackAgents: ['coder'],\n    pipelinePhases: ['file-discovery', 'coverage-analysis', 'gap-detection'],\n    memoryKeyPattern: 'testgaps/{module}/{coverage}'\n  }],\n  ['document', {\n    trigger: 'document',\n    recommendedAgents: ['documenter', 'researcher'],\n    fallbackAgents: ['coder'],\n    pipelinePhases: ['api-discovery', 'doc-generation', 'indexing'],\n    memoryKeyPattern: 'docs/{topic}/{section}'\n  }],\n  ['deepdive', {\n    trigger: 'deepdive',\n    recommendedAgents: ['researcher', 'security-analyst'],\n    fallbackAgents: ['coder'],\n    pipelinePhases: ['call-graph', 'dependency-graph', 'trace-analysis'],\n    memoryKeyPattern: 'deepdive/{topic}/{level}'\n  }],\n  ['refactor', {\n    trigger: 'refactor',\n    recommendedAgents: ['coder', 'reviewer'],\n    fallbackAgents: ['researcher'],\n    pipelinePhases: ['complexity-analysis', 'code-smell-detection', 'pattern-extraction'],\n    memoryKeyPattern: 'refactor/{topic}/{improvement}'\n  }],\n  ['map', {\n    trigger: 'map',\n    recommendedAgents: ['researcher'],\n    fallbackAgents: ['coder'],\n    pipelinePhases: ['dependency-discovery', 'graph-build', 'indexing'],\n    memoryKeyPattern: 'map/{module}/{relationship}'\n  }],\n  ['preload', {\n    trigger: 'preload',\n    recommendedAgents: ['researcher'],\n    fallbackAgents: [],\n    pipelinePhases: ['file-discovery', 'vectorization'],\n    memoryKeyPattern: 'preload/{context}/{file}'\n  }],\n  ['predict', {\n    trigger: 'predict',\n    recommendedAgents: ['performance-analyzer'],\n    fallbackAgents: ['researcher'],\n    pipelinePhases: ['pattern-discovery', 'prediction'],\n    memoryKeyPattern: 'predict/{context}/{next}'\n  }],\n  ['consolidate', {\n    trigger: 'consolidate',\n    recommendedAgents: ['researcher'],\n    fallbackAgents: [],\n    pipelinePhases: ['pattern-extraction', 'pattern-storage'],\n    memoryKeyPattern: 'consolidate/{session}/{pattern}'\n  }]\n]);\n\n// ============================================================================\n// Performance Tracking\n// ============================================================================\n\nconst agentPerformanceProfiles: Map<string, AgentPerformanceProfile> = new Map();\n\nfunction updateAgentPerformance(\n  agentName: string,\n  latencyMs: number,\n  success: boolean,\n  memoryMB: number,\n  quality: number\n): void {\n  const existing = agentPerformanceProfiles.get(agentName);\n  const count = existing?.executionCount || 0;\n\n  // Exponential moving average\n  const alpha = 0.2;\n\n  if (existing) {\n    existing.avgLatencyMs = alpha * latencyMs + (1 - alpha) * existing.avgLatencyMs;\n    existing.p95LatencyMs = Math.max(latencyMs, existing.p95LatencyMs * 0.95);\n    existing.successRate = alpha * (success ? 1 : 0) + (1 - alpha) * existing.successRate;\n    existing.memoryUsageMB = alpha * memoryMB + (1 - alpha) * existing.memoryUsageMB;\n    existing.qualityScore = alpha * quality + (1 - alpha) * existing.qualityScore;\n    existing.executionCount = count + 1;\n    existing.lastExecuted = Date.now();\n  } else {\n    agentPerformanceProfiles.set(agentName, {\n      agentName,\n      capabilities: AGENT_CAPABILITIES.get(agentName)?.triggers || [],\n      avgLatencyMs: latencyMs,\n      p95LatencyMs: latencyMs,\n      successRate: success ? 1 : 0,\n      memoryUsageMB: memoryMB,\n      qualityScore: quality,\n      executionCount: 1,\n      lastExecuted: Date.now()\n    });\n  }\n}\n\n// ============================================================================\n// Worker-Agent Integration Manager\n// ============================================================================\n\nexport class WorkerAgentIntegration {\n  private memoryPatterns: Map<string, unknown[]> = new Map();\n  private feedbackQueue: Array<{\n    trigger: WorkerTrigger;\n    agent: string;\n    success: boolean;\n    latency: number;\n    quality: number;\n  }> = [];\n\n  /**\n   * Get recommended agents for a worker trigger\n   */\n  getRecommendedAgents(trigger: WorkerTrigger): {\n    primary: string[];\n    fallback: string[];\n    phases: string[];\n    memoryPattern: string;\n  } {\n    const mapping = WORKER_AGENT_MAPPINGS.get(trigger);\n    if (!mapping) {\n      return {\n        primary: ['researcher'],\n        fallback: [],\n        phases: ['file-discovery', 'summarization'],\n        memoryPattern: `${trigger}/{topic}/{phase}`\n      };\n    }\n\n    // Sort by performance if we have data\n    const sortedPrimary = [...mapping.recommendedAgents].sort((a, b) => {\n      const profA = agentPerformanceProfiles.get(a);\n      const profB = agentPerformanceProfiles.get(b);\n      if (!profA) return 1;\n      if (!profB) return -1;\n      return profB.qualityScore - profA.qualityScore;\n    });\n\n    return {\n      primary: sortedPrimary,\n      fallback: mapping.fallbackAgents,\n      phases: mapping.pipelinePhases,\n      memoryPattern: mapping.memoryKeyPattern\n    };\n  }\n\n  /**\n   * Get agent capabilities for matching\n   */\n  getAgentCapabilities(agentName: string): AgentCapability | undefined {\n    return AGENT_CAPABILITIES.get(agentName);\n  }\n\n  /**\n   * Find best agent for a given trigger based on performance history\n   */\n  selectBestAgent(trigger: WorkerTrigger): {\n    agent: string;\n    confidence: number;\n    reasoning: string;\n  } {\n    const { primary, fallback } = this.getRecommendedAgents(trigger);\n    const candidates = [...primary, ...fallback];\n\n    if (candidates.length === 0) {\n      return {\n        agent: 'researcher',\n        confidence: 0.5,\n        reasoning: 'Default agent - no specific mapping'\n      };\n    }\n\n    // Find best performing agent\n    let bestAgent = candidates[0];\n    let bestScore = 0;\n\n    for (const agent of candidates) {\n      const profile = agentPerformanceProfiles.get(agent);\n      if (profile) {\n        // Combined score: quality * success_rate * (1 / latency_factor)\n        const latencyFactor = Math.max(1, profile.avgLatencyMs / 100);\n        const score = profile.qualityScore * profile.successRate * (1 / latencyFactor);\n        if (score > bestScore) {\n          bestScore = score;\n          bestAgent = agent;\n        }\n      }\n    }\n\n    const profile = agentPerformanceProfiles.get(bestAgent);\n    const confidence = profile\n      ? Math.min(0.95, 0.5 + (profile.executionCount * 0.01) + (profile.qualityScore * 0.4))\n      : 0.6;\n\n    return {\n      agent: bestAgent,\n      confidence,\n      reasoning: profile\n        ? `Selected based on ${profile.executionCount} executions with ${(profile.successRate * 100).toFixed(1)}% success`\n        : 'No performance history - using default recommendation'\n    };\n  }\n\n  /**\n   * Record agent execution feedback for learning\n   */\n  recordFeedback(\n    trigger: WorkerTrigger,\n    agentName: string,\n    success: boolean,\n    latencyMs: number,\n    qualityScore: number,\n    memoryMB: number = 0\n  ): void {\n    updateAgentPerformance(agentName, latencyMs, success, memoryMB, qualityScore);\n\n    this.feedbackQueue.push({\n      trigger,\n      agent: agentName,\n      success,\n      latency: latencyMs,\n      quality: qualityScore\n    });\n\n    // Process feedback queue periodically\n    if (this.feedbackQueue.length > 50) {\n      this.processFeedbackQueue();\n    }\n  }\n\n  /**\n   * Process accumulated feedback for learning\n   */\n  private processFeedbackQueue(): void {\n    // Group by trigger and agent\n    const grouped = new Map<string, typeof this.feedbackQueue>();\n\n    for (const feedback of this.feedbackQueue) {\n      const key = `${feedback.trigger}:${feedback.agent}`;\n      const group = grouped.get(key) || [];\n      group.push(feedback);\n      grouped.set(key, group);\n    }\n\n    // Calculate aggregate metrics\n    for (const [key, feedbacks] of grouped) {\n      const avgQuality = feedbacks.reduce((sum, f) => sum + f.quality, 0) / feedbacks.length;\n      const avgLatency = feedbacks.reduce((sum, f) => sum + f.latency, 0) / feedbacks.length;\n      const successRate = feedbacks.filter(f => f.success).length / feedbacks.length;\n\n      // Store as pattern for future retrieval\n      const patternKey = `learning/agent-performance/${key.replace(':', '/')}`;\n      this.memoryPatterns.set(patternKey, [{\n        avgQuality,\n        avgLatency,\n        successRate,\n        sampleCount: feedbacks.length,\n        updatedAt: Date.now()\n      }]);\n    }\n\n    this.feedbackQueue = [];\n  }\n\n  /**\n   * Get performance metrics for all agents\n   */\n  getAgentMetrics(): AgentPerformanceProfile[] {\n    return Array.from(agentPerformanceProfiles.values());\n  }\n\n  /**\n   * Get performance metrics for specific trigger\n   */\n  getTriggerMetrics(trigger: WorkerTrigger): {\n    trigger: WorkerTrigger;\n    totalExecutions: number;\n    avgLatencyMs: number;\n    successRate: number;\n    topAgents: Array<{ agent: string; score: number }>;\n  } {\n    const { primary, fallback } = this.getRecommendedAgents(trigger);\n    const agents = [...primary, ...fallback];\n\n    let totalExecutions = 0;\n    let totalLatency = 0;\n    let successCount = 0;\n\n    const agentScores: Array<{ agent: string; score: number }> = [];\n\n    for (const agent of agents) {\n      const profile = agentPerformanceProfiles.get(agent);\n      if (profile) {\n        totalExecutions += profile.executionCount;\n        totalLatency += profile.avgLatencyMs * profile.executionCount;\n        successCount += profile.successRate * profile.executionCount;\n        agentScores.push({\n          agent,\n          score: profile.qualityScore * profile.successRate\n        });\n      }\n    }\n\n    return {\n      trigger,\n      totalExecutions,\n      avgLatencyMs: totalExecutions > 0 ? totalLatency / totalExecutions : 0,\n      successRate: totalExecutions > 0 ? successCount / totalExecutions : 0,\n      topAgents: agentScores.sort((a, b) => b.score - a.score).slice(0, 3)\n    };\n  }\n\n  /**\n   * Get benchmark thresholds for an agent\n   */\n  getBenchmarkThresholds(agentName: string): BenchmarkThreshold[] {\n    return AGENT_CAPABILITIES.get(agentName)?.benchmarkThresholds || [];\n  }\n\n  /**\n   * Check if agent meets benchmark thresholds\n   */\n  checkBenchmarkCompliance(agentName: string): {\n    compliant: boolean;\n    violations: Array<{ metric: string; actual: number; target: number }>;\n  } {\n    const thresholds = this.getBenchmarkThresholds(agentName);\n    const profile = agentPerformanceProfiles.get(agentName);\n\n    if (!profile || thresholds.length === 0) {\n      return { compliant: true, violations: [] };\n    }\n\n    const violations: Array<{ metric: string; actual: number; target: number }> = [];\n\n    for (const threshold of thresholds) {\n      let actual: number;\n      switch (threshold.metric) {\n        case 'p95_latency':\n          actual = profile.p95LatencyMs;\n          break;\n        case 'memory_mb':\n          actual = profile.memoryUsageMB;\n          break;\n        case 'quality_score':\n          actual = profile.qualityScore;\n          break;\n        default:\n          continue;\n      }\n\n      const passed = threshold.direction === 'below'\n        ? actual <= threshold.target\n        : actual >= threshold.target;\n\n      if (!passed) {\n        violations.push({\n          metric: threshold.metric,\n          actual,\n          target: threshold.target\n        });\n      }\n    }\n\n    return {\n      compliant: violations.length === 0,\n      violations\n    };\n  }\n\n  /**\n   * Generate memory key for worker-agent communication\n   */\n  generateMemoryKey(trigger: WorkerTrigger, topic: string, phase: string): string {\n    const mapping = WORKER_AGENT_MAPPINGS.get(trigger);\n    const pattern = mapping?.memoryKeyPattern || `${trigger}/{topic}/{phase}`;\n\n    return pattern\n      .replace('{topic}', topic || 'default')\n      .replace('{phase}', phase)\n      .replace('{metric}', phase)\n      .replace('{finding}', phase)\n      .replace('{module}', topic || 'main')\n      .replace('{section}', phase)\n      .replace('{level}', '0')\n      .replace('{improvement}', phase)\n      .replace('{relationship}', phase)\n      .replace('{context}', topic || 'default')\n      .replace('{file}', phase)\n      .replace('{next}', phase)\n      .replace('{pattern}', phase)\n      .replace('{coverage}', phase);\n  }\n\n  /**\n   * Get integration statistics\n   */\n  getStats(): {\n    totalAgents: number;\n    trackedAgents: number;\n    totalFeedback: number;\n    avgQualityScore: number;\n    modelCacheStats: { hits: number; misses: number; hitRate: string };\n  } {\n    const profiles = Array.from(agentPerformanceProfiles.values());\n    const totalExecutions = profiles.reduce((sum, p) => sum + p.executionCount, 0);\n    const avgQuality = profiles.length > 0\n      ? profiles.reduce((sum, p) => sum + p.qualityScore, 0) / profiles.length\n      : 0;\n\n    const cacheStats = modelCache.getStats();\n\n    return {\n      totalAgents: AGENT_CAPABILITIES.size,\n      trackedAgents: profiles.length,\n      totalFeedback: totalExecutions,\n      avgQualityScore: avgQuality,\n      modelCacheStats: {\n        hits: cacheStats.hits,\n        misses: cacheStats.misses,\n        hitRate: `${(cacheStats.hitRate * 100).toFixed(1)}%`\n      }\n    };\n  }\n}\n\n// Singleton instance\nexport const workerAgentIntegration = new WorkerAgentIntegration();\n\n// ============================================================================\n// Convenience Functions\n// ============================================================================\n\nexport function getAgentForTrigger(trigger: WorkerTrigger): string {\n  return workerAgentIntegration.selectBestAgent(trigger).agent;\n}\n\nexport function recordAgentPerformance(\n  trigger: WorkerTrigger,\n  agent: string,\n  success: boolean,\n  latencyMs: number,\n  quality: number\n): void {\n  workerAgentIntegration.recordFeedback(trigger, agent, success, latencyMs, quality);\n}\n\nexport function getIntegrationStats() {\n  return workerAgentIntegration.getStats();\n}\n"]}